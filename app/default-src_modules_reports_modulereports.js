/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-11-19 12:43:46
 *
 *                     build: 2023.02.001.1700397826672
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["default-src_modules_reports_modulereports_ts"],{8477:(e,t,i)=>{i.d(t,{h:()=>d});var s=i(2242),n=i(5329),r=i(5710),o=i(4542),a=i(5030),l=i(6822);let d=(()=>{class ReporterFilterItemDate{language;model;reporterconfig;field="";wherecondition={};fieldDate=new moment;constructor(e,t,i){this.language=e,this.model=t,this.reporterconfig=i}ngOnInit(){this.fieldDate=new moment(this.wherecondition[this.field])}get filterValue(){return this.fieldDate}set filterValue(e){this.fieldDate=e,this.wherecondition[this.field]=e.format("YYYY-MM-DD")}static ɵfac=function(e){return new(e||ReporterFilterItemDate)(s.Y36(n.d),s.Y36(r.o),s.Y36(o.s))};static ɵcmp=s.Xpm({type:ReporterFilterItemDate,selectors:[["reporter-filter-item-date"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:2,vars:1,consts:[[1,"slds-form-element"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0)(1,"system-input-date",1),s.NdJ("ngModelChange",(function(e){return t.filterValue=e})),s.qZA()()),2&e&&(s.xp6(1),s.Q6J("ngModel",t.filterValue))},dependencies:[a.JJ,a.On,l.z],encapsulation:2})}return ReporterFilterItemDate})()},3411:(e,t,i)=>{i.d(t,{i:()=>v});var s=i(727),n=i(2242),r=i(4154),o=i(5329),a=i(4505),l=i(4755),d=i(5030),c=i(9503),p=i(8658);function u(e,t){if(1&e&&(n.TgZ(0,"option",7),n._uU(1),n.qZA()),2&e){const e=t.$implicit;n.Q6J("ngValue",e.value),n.xp6(1),n.Oqu(e.display)}}function h(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",3)(1,"div",4)(2,"select",5),n.NdJ("ngModelChange",(function(t){n.CHM(e);const i=n.oxw();return n.KtG(i.value=t)})),n.YNc(3,u,2,2,"option",6),n.qZA()()()}if(2&e){const e=n.oxw();n.xp6(2),n.Q6J("disabled",e.isDisabled)("ngModel",e.value),n.xp6(1),n.Q6J("ngForOf",e.enumOptions)}}function g(e,t){if(1&e&&(n.TgZ(0,"div",11)(1,"system-checkbox-group-checkbox",12)(2,"span",13),n._uU(3),n.qZA()()()),2&e){const e=n.oxw().$implicit;n.Q6J("title",e.display),n.xp6(1),n.Q6J("value",e.value),n.xp6(2),n.Oqu(e.display)}}function f(e,t){if(1&e&&(n.ynx(0),n.YNc(1,g,4,3,"div",10),n.BQk()),2&e){const e=t.$implicit;n.xp6(1),n.Q6J("ngIf",!!e.value)}}function m(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"system-checkbox-group",8),n.NdJ("ngModelChange",(function(t){n.CHM(e);const i=n.oxw();return n.KtG(i.value=t)})),n.YNc(1,f,2,1,"ng-container",9),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("ngModel",e.value),n.xp6(1),n.Q6J("ngForOf",e.enumOptions)}}let v=(()=>{class ReporterFilterItemEnum{metadata;language;backend;field="";isMultiSelect=!1;wherecondition={};fieldName;moduleName;enumOptions=[];_value=[];subscription=new s.w0;constructor(e,t,i){this.metadata=e,this.language=t,this.backend=i,this.subscription=this.language.currentlanguage$.subscribe((()=>{this.getEnumOptions()}))}get isDisabled(){return 0==this.enumOptions.length}get value(){return this._value}set value(e){this.isMultiSelect&&(this._value=e,e=e.join(",")),this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];let s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":let e=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=e.module}this.getEnumOptions(),this.initializeValueArray()}ngOnDestroy(){this.subscription.unsubscribe()}initializeValueArray(){const e=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field];this._value=this.isMultiSelect?e?e.split(","):[]:e}getEnumOptions(){this.moduleName&&this.fieldName?this.enumOptions=this.language.getFieldDisplayOptions(this.moduleName,this.fieldName,!0):this.backend.getRequest("module/KReports/core/enumoptions",{path:this.wherecondition.path}).subscribe((e=>{e&&0!=e.length&&(this.enumOptions=e.map((e=>({value:e.value,display:e.text}))))}))}ngOnChanges(){this.initializeValueArray()}static ɵfac=function(e){return new(e||ReporterFilterItemEnum)(n.Y36(r.Pu),n.Y36(o.d),n.Y36(a.y))};static ɵcmp=n.Xpm({type:ReporterFilterItemEnum,selectors:[["reporter-filter-item-enum"]],inputs:{field:"field",isMultiSelect:"isMultiSelect",wherecondition:"wherecondition"},features:[n.TTD],decls:4,vars:2,consts:[[1,"slds-form-element"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["checkboxContainer",""],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"slds-grid","slds-wrap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["class","slds-large-size--1-of-3 slds-medium-size--1-of-1 slds-truncate",3,"title",4,"ngIf"],[1,"slds-large-size--1-of-3","slds-medium-size--1-of-1","slds-truncate",3,"title"],[3,"value"],[1,"slds-m-left--xx-small"]],template:function(e,t){if(1&e&&(n.TgZ(0,"div",0),n.YNc(1,h,4,3,"div",1),n.YNc(2,m,2,2,"ng-template",null,2,n.W1O),n.qZA()),2&e){const e=n.MAs(3);n.xp6(1),n.Q6J("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[l.sg,l.O5,d.YN,d.Kr,d.EJ,d.JJ,d.On,c.L,p.m],encapsulation:2})}return ReporterFilterItemEnum})()},7832:(e,t,i)=>{i.d(t,{K:()=>d});var s=i(2242),n=i(5329),r=i(4542),o=i(4755),a=i(5030);function l(e,t){if(1&e&&(s.TgZ(0,"option",5),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.Q6J("value",e.field),s.xp6(1),s.hij(" ",e.description," ")}}let d=(()=>{class ReporterFilterItemFunction{language;reporterconfig;whereCondition={};constructor(e,t){this.language=e,this.reporterconfig=t}set functionField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get functionField(){return this.whereCondition.value}static ɵfac=function(e){return new(e||ReporterFilterItemFunction)(s.Y36(n.d),s.Y36(r.s))};static ɵcmp=s.Xpm({type:ReporterFilterItemFunction,selectors:[["reporter-filter-item-function"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),s.NdJ("ngModelChange",(function(e){return t.functionField=e})),s.YNc(4,l,2,2,"option",4),s.qZA()()()()),2&e&&(s.xp6(3),s.Q6J("ngModel",t.functionField),s.xp6(1),s.Q6J("ngForOf",t.reporterconfig.whereFunctions))},dependencies:[o.sg,a.YN,a.Kr,a.EJ,a.JJ,a.On],encapsulation:2})}return ReporterFilterItemFunction})()},5336:(e,t,i)=>{i.d(t,{g:()=>u});var s=i(727),n=i(2242),r=i(4154),o=i(5329),a=i(4505),l=i(5710),d=i(4755),c=i(5030);function p(e,t){if(1&e&&(n.TgZ(0,"option",5),n._uU(1),n.qZA()),2&e){const e=t.$implicit;n.Q6J("value",e),n.xp6(1),n.Oqu(e)}}let u=(()=>{class ReporterFilterItemParent{metadata;language;backend;model;field="";wherecondition={};fieldName;moduleName;fields=[];_value;subscription=new s.w0;constructor(e,t,i,s){this.metadata=e,this.language=t,this.backend=i,this.model=s,this.getEnumOptions()}get isDisabled(){return 0==this.fields.length}get value(){return this._value}set value(e){this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];let s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":let e=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=e.module}this.getEnumOptions(),this._value=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field]}ngOnDestroy(){this.subscription.unsubscribe()}getEnumOptions(){this.fields=[];const e=this.model.getField("integration_params");let t=this.metadata.getModuleFields(e.kpublishing.subpanelModule);for(let e in t)this.fields.push(e);this.fields.sort()}static ɵfac=function(e){return new(e||ReporterFilterItemParent)(n.Y36(r.Pu),n.Y36(o.d),n.Y36(a.y),n.Y36(l.o))};static ɵcmp=n.Xpm({type:ReporterFilterItemParent,selectors:[["reporter-filter-item-parent"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:5,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),n.NdJ("ngModelChange",(function(e){return t.value=e})),n.YNc(4,p,2,2,"option",4),n.qZA()()()()),2&e&&(n.xp6(3),n.Q6J("disabled",t.isDisabled)("ngModel",t.value),n.xp6(1),n.Q6J("ngForOf",t.fields))},dependencies:[d.sg,c.YN,c.Kr,c.EJ,c.JJ,c.On],encapsulation:2})}return ReporterFilterItemParent})()},6257:(e,t,i)=>{i.d(t,{W:()=>p});var s=i(2242),n=i(5329),r=i(4542),o=i(5710),a=i(4755),l=i(5030),d=i(3463);function c(e,t){if(1&e&&(s.TgZ(0,"option",5),s._UZ(1,"system-label",6),s.qZA()),2&e){const e=t.$implicit;s.Q6J("value",e.reference),s.xp6(1),s.Q6J("label",e.reference)}}let p=(()=>{class ReporterFilterItemReference{language;reporterConfig;model;whereCondition={};fieldName;constructor(e,t,i){this.language=e,this.reporterConfig=t,this.model=i}set referenceField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get referenceField(){return this.whereCondition.value}get referenceFields(){const e=this.model.getField("whereconditions"),t=this.reporterConfig.operatorAssignments[this.whereCondition.overrideType||this.whereCondition.type]||"varchar";return e.filter((e=>!!e.reference&&(this.reporterConfig.operatorAssignments[e.type]||"varchar")==t&&this.whereCondition.fieldid!=e.fieldid))}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}static ɵfac=function(e){return new(e||ReporterFilterItemReference)(s.Y36(n.d),s.Y36(r.s),s.Y36(o.o))};static ɵcmp=s.Xpm({type:ReporterFilterItemReference,selectors:[["reporter-filter-item-reference"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"label"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),s.NdJ("ngModelChange",(function(e){return t.referenceField=e})),s.YNc(4,c,2,2,"option",4),s.qZA()()()()),2&e&&(s.xp6(3),s.Q6J("ngModel",t.referenceField),s.xp6(1),s.Q6J("ngForOf",t.referenceFields))},dependencies:[a.sg,l.YN,l.Kr,l.EJ,l.JJ,l.On,d._],encapsulation:2})}return ReporterFilterItemReference})()},8717:(e,t,i)=>{i.d(t,{I:()=>l});var s=i(2242),n=i(5329),r=i(5710),o=i(4542),a=i(5030);let l=(()=>{class ReporterFilterItemText{language;model;reporterconfig;field="";wherecondition={};constructor(e,t,i){this.language=e,this.model=t,this.reporterconfig=i}static ɵfac=function(e){return new(e||ReporterFilterItemText)(s.Y36(n.d),s.Y36(r.o),s.Y36(o.s))};static ɵcmp=s.Xpm({type:ReporterFilterItemText,selectors:[["reporter-filter-item-text"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:3,vars:1,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"input",2),s.NdJ("ngModelChange",(function(e){return t.wherecondition[t.field]=e})),s.qZA()()()),2&e&&(s.xp6(2),s.Q6J("ngModel",t.wherecondition[t.field]))},dependencies:[a.Fj,a.JJ,a.On],encapsulation:2})}return ReporterFilterItemText})()},429:(e,t,i)=>{i.d(t,{f:()=>d});var s=i(2242),n=i(4755),r=i(6434),o=i(1512);function a(e,t){if(1&e&&s._UZ(0,"reporter-filter-item-user-single",3),2&e){const e=s.oxw();s.Q6J("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}function l(e,t){if(1&e&&s._UZ(0,"reporter-filter-item-user-multiple",3),2&e){const e=s.oxw();s.Q6J("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}let d=(()=>{class ReporterFilterItemUser{whereCondition={};fieldName;get isMultiSelect(){switch(this.whereCondition.operator){case"oneof":case"oneofnot":case"oneofnotornull":return!0;default:return!1}}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}static ɵfac=function(e){return new(e||ReporterFilterItemUser)};static ɵcmp=s.Xpm({type:ReporterFilterItemUser,selectors:[["reporter-filter-item-user"]],inputs:{whereCondition:"whereCondition"},decls:4,vars:2,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["class","slds-grid slds-grid--vertical-align-center slds-size--1-of-1",3,"whereCondition","fieldName",4,"ngIf","ngIfElse"],["multipleSelectContainer",""],[1,"slds-grid","slds-grid--vertical-align-center","slds-size--1-of-1",3,"whereCondition","fieldName"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0),s.YNc(1,a,1,2,"reporter-filter-item-user-single",1),s.YNc(2,l,1,2,"ng-template",null,2,s.W1O),s.qZA()),2&e){const e=s.MAs(3);s.xp6(1),s.Q6J("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[n.O5,r.i,o.Q],encapsulation:2})}return ReporterFilterItemUser})()},1512:(e,t,i)=>{i.d(t,{Q:()=>b});var s=i(2242),n=i(5329),r=i(4044),o=i(5920),a=i(4755),l=i(5030),d=i(2656),c=i(7514),p=i(4561),u=i(3463);function h(e,t){if(1&e&&(s.TgZ(0,"span",23),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.hij(" ",e," ")}}function g(e,t){if(1&e&&(s.TgZ(0,"span",23),s._uU(1),s.qZA()),2&e){const e=s.oxw(3);s.xp6(1),s.hij(" ",e.activeUserName," ")}}function f(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"li",15)(1,"span",16)(2,"span",17),s._UZ(3,"system-icon",18),s.qZA(),s.YNc(4,h,2,1,"span",19),s.YNc(5,g,2,1,"ng-template",null,20,s.W1O),s.TgZ(7,"span",21)(8,"system-button-icon",22),s.NdJ("click",(function(){const t=s.CHM(e).$implicit,i=s.oxw(2);return s.KtG(i.removeUser(t))})),s.qZA()()()()}if(2&e){const e=t.$implicit,i=s.MAs(6);s.xp6(4),s.Q6J("ngIf","current_user_id"!=e)("ngIfElse",i),s.xp6(4),s.Q6J("icon","close")}}function m(e,t){if(1&e&&(s.TgZ(0,"div",12)(1,"ul",13),s.YNc(2,f,9,3,"li",14),s.qZA()()),2&e){const e=s.oxw();s.xp6(2),s.Q6J("ngForOf",e.value)("ngForTrackBy",e.trackByFn)}}function v(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",24)(1,"div",25)(2,"input",26),s.NdJ("focus",(function(){s.CHM(e);const t=s.oxw();return s.KtG(t.searchWithModal())})),s.qZA(),s.TgZ(3,"button",8),s.NdJ("click",(function(){s.CHM(e);const t=s.oxw();return s.KtG(t.searchWithModal())})),s._UZ(4,"system-button-icon",9),s.qZA()()()}if(2&e){const e=s.oxw();s.xp6(2),s.Q6J("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),s.xp6(2),s.Q6J("icon","search")}}let b=(()=>{class ReporterFilterItemUserMultiple{language;modal;session;whereCondition={};fieldName;activeUserName="";constructor(e,t,i){this.language=e,this.modal=t,this.session=i}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?[...this.whereCondition.value,"current_user_id"]:this.whereCondition.value.filter((e=>"current_user_id"!=e)).slice()}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.value=e,this.whereCondition.valueinit=e.join(","))}ngOnInit(){this.activeUserName=this.session.authData.userName}trackByFn(e,t){return t}removeUser(e){this.value=this.whereCondition.value.filter((t=>t!=e)).slice()}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}static ɵfac=function(e){return new(e||ReporterFilterItemUserMultiple)(s.Y36(n.d),s.Y36(r.o),s.Y36(o.n))};static ɵcmp=s.Xpm({type:ReporterFilterItemUserMultiple,selectors:[["reporter-filter-item-user-multiple"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:13,vars:4,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["class","slds-pill_container",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-grow"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-pill_container"],["role","listbox",1,"slds-listbox","slds-listbox_horizontal"],["class","slds-listbox-item","role","presentation",4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-listbox-item"],["role","option",1,"slds-pill"],[1,"slds-icon_container"],["module","Users","size","x-small","divClass","slds-p-right--x-small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-icon_container","slds-pill__remove"],[3,"icon","click"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),s.YNc(5,m,3,2,"div",5),s.YNc(6,v,5,2,"ng-template",null,6,s.W1O),s.TgZ(8,"div",7)(9,"button",8),s.NdJ("click",(function(){return t.searchWithModal()})),s._UZ(10,"system-button-icon",9),s.qZA()()()()()()(),s.TgZ(11,"system-checkbox",10),s.NdJ("ngModelChange",(function(e){return t.activeUser=e})),s._UZ(12,"system-label",11),s.qZA()),2&e){const e=s.MAs(7);s.xp6(5),s.Q6J("ngIf",t.value.length>0)("ngIfElse",e),s.xp6(5),s.Q6J("icon","search"),s.xp6(1),s.Q6J("ngModel",t.activeUser)}},dependencies:[a.sg,a.O5,l.JJ,l.On,d.J,c.U,p.f,u._],encapsulation:2})}return ReporterFilterItemUserMultiple})()},6434:(e,t,i)=>{i.d(t,{i:()=>v});var s=i(2242),n=i(5329),r=i(4044),o=i(5920),a=i(4755),l=i(5030),d=i(2656),c=i(7514),p=i(4561),u=i(3463);function h(e,t){if(1&e&&(s.TgZ(0,"span",18),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",e.value," ")}}function g(e,t){if(1&e&&(s.TgZ(0,"span",18),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",e.activeUserName," ")}}function f(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",9)(1,"div",10)(2,"span",11)(3,"span",12),s._UZ(4,"system-icon",13),s.qZA(),s.YNc(5,h,2,1,"span",14),s.YNc(6,g,2,1,"ng-template",null,15,s.W1O),s.TgZ(8,"button",16),s.NdJ("click",(function(){s.CHM(e);const t=s.oxw();return s.KtG(t.clearField())})),s._UZ(9,"system-button-icon",17),s.qZA()()()()}if(2&e){const e=s.MAs(7),t=s.oxw();s.xp6(5),s.Q6J("ngIf","current_user_id"!=t.value)("ngIfElse",e),s.xp6(4),s.Q6J("icon","close")}}function m(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",19)(1,"div",20)(2,"input",21),s.NdJ("focus",(function(){s.CHM(e);const t=s.oxw();return s.KtG(t.searchWithModal())})),s.qZA(),s.TgZ(3,"button",22),s.NdJ("click",(function(){s.CHM(e);const t=s.oxw();return s.KtG(t.searchWithModal())})),s._UZ(4,"system-button-icon",17),s.qZA()()()}if(2&e){const e=s.oxw();s.xp6(2),s.Q6J("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),s.xp6(2),s.Q6J("icon","search")}}let v=(()=>{class ReporterFilterItemUserSingle{language;modal;session;whereCondition={};fieldName;activeUserName="";constructor(e,t,i){this.language=e,this.modal=t,this.session=i}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?["current_user_id"]:[""]}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.valuekey=e[0],this.whereCondition.value=e[0])}ngOnInit(){this.activeUserName=this.session.authData.userName}clearField(){this.whereCondition.value="",this.whereCondition.valuekey=""}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}static ɵfac=function(e){return new(e||ReporterFilterItemUserSingle)(s.Y36(n.d),s.Y36(r.o),s.Y36(o.n))};static ɵcmp=s.Xpm({type:ReporterFilterItemUserSingle,selectors:[["reporter-filter-item-user-single"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:10,vars:3,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],[1,"slds-form-element","slds-lookup"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-form-element__control"],[1,"slds-pill_container"],[1,"slds-pill","slds-size--1-of-1"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],["module","Users","size","small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"],[3,"icon"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),s.YNc(5,f,10,3,"div",5),s.YNc(6,m,5,2,"ng-template",null,6,s.W1O),s.qZA()()()()(),s.TgZ(8,"system-checkbox",7),s.NdJ("ngModelChange",(function(e){return t.activeUser=e})),s._UZ(9,"system-label",8),s.qZA()),2&e){const e=s.MAs(7);s.xp6(5),s.Q6J("ngIf",!!t.value)("ngIfElse",e),s.xp6(3),s.Q6J("ngModel",t.activeUser)}},dependencies:[a.O5,l.JJ,l.On,d.J,c.U,p.f,u._],encapsulation:2})}return ReporterFilterItemUserSingle})()},6820:(e,t,i)=>{i.r(t),i.d(t,{ModuleReports:()=>pi});var s=i(4755),n=i(5030),r=i(3190),o=i(6490),a=i(3735),l=i(4357),d=i(3418),c=i(2242),p=i(5710),u=i(4542),h=i(1591),g=i(2294),f=i(727),m=i(3369),v=i(5329),b=i(4154),w=i(4505),y=i(3348),x=i(7017),F=i(3194),R=i(2613),C=i(8861),Z=i(5931),k=i(4778),I=i(4561),T=i(3333),D=i(3814),J=i(2656),A=i(3463);const M=["actionitems"];let Y=(()=>{class ReporterFilterButton{language;reporterconfig;actionitems;whereConditions={};hasUserFilters=!1;showFilters=!1;filter=new c.vpe;constructor(e,t){this.language=e,this.reporterconfig=t}ngOnChanges(){if(Array.isArray(this.whereConditions))for(let e of this.whereConditions)"yes"==e.usereditable&&(this.reporterconfig.addUserFilter(e),this.hasUserFilters=!0)}ngOnDestroy(){}toggleFilters(){this.showFilters=!this.showFilters,this.filter.emit(this.showFilters)}static ɵfac=function(e){return new(e||ReporterFilterButton)(c.Y36(v.d),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterFilterButton,selectors:[["reporter-filter-button"]],viewQuery:function(e,t){if(1&e&&c.Gf(M,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.actionitems=e.first)}},inputs:{whereConditions:"whereConditions"},outputs:{filter:"filter"},features:[c.TTD],decls:4,vars:2,consts:[[1,"slds-button","slds-button--neutral","slds-grid","slds-grid--vertical-align-center",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"disabled","click"],["label","LBL_FILTER"],[1,"slds-p-horizontal--xxx-small",3,"icon"]],template:function(e,t){1&e&&(c.TgZ(0,"button",0),c.NdJ("click",(function(){return t.toggleFilters()})),c.TgZ(1,"span"),c._UZ(2,"system-label",1),c.qZA(),c._UZ(3,"system-button-icon",2),c.qZA()),2&e&&(c.Q6J("disabled",!t.hasUserFilters),c.xp6(3),c.Q6J("icon","filterList"))},dependencies:[J.J,A._],encapsulation:2})}return ReporterFilterButton})();var q=i(4361);const N=["actionItemsContainer"];let P=(()=>{class ReporterIntegrationExportButton{language;metadata;model;actionItemsContainer;integrationParams={};actionComponentRefs=[];constructor(e,t,i){this.language=e,this.metadata=t,this.model=i}get isDisabled(){if(!this.model.checkAccess("export"))return!1;if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":case"kcsvexport":case"kexcelexport":case"kpdfexport":case"kplannerexport":if(1==this.integrationParams.activePlugins[e])return!1}return!0}ngAfterViewInit(){this.renderActionItems()}ngOnChanges(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":1==this.integrationParams.activePlugins.ktargetlistexport&&this.renderActionItem("ReporterIntegrationTargetlistexportButton");break;case"kcsvexport":1==this.integrationParams.activePlugins.kcsvexport&&this.renderActionItem("ReporterIntegrationCSVexportButton");break;case"kexcelexport":1==this.integrationParams.activePlugins.kexcelexport&&this.renderActionItem("ReporterIntegrationXLSexportButton");break;case"kpdfexport":1==this.integrationParams.activePlugins.kpdfexport&&this.renderActionItem("ReporterIntegrationPDFexportButton");break;case"kplannerexport":1==this.integrationParams.activePlugins.kplannerexport&&this.renderActionItem("SalesPlanningReporterIntegrationExportButton")}}renderActionItem(e){this.metadata.addComponent(e,this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}static ɵfac=function(e){return new(e||ReporterIntegrationExportButton)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(p.o))};static ɵcmp=c.Xpm({type:ReporterIntegrationExportButton,selectors:[["reporter-integration-export-button"]],viewQuery:function(e,t){if(1&e&&c.Gf(N,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[c.TTD],decls:9,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-top-right-radius","0","border-bottom-right-radius","0",3,"disabled"],["label","LBL_EXPORT"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"button",1)(2,"span"),c._UZ(3,"system-label",2),c.qZA(),c._UZ(4,"system-button-icon",3),c.qZA(),c.TgZ(5,"div",4)(6,"ul",5),c._UZ(7,"div",null,6),c.qZA()()()),2&e&&(c.xp6(1),c.Q6J("disabled",t.isDisabled),c.xp6(3),c.Q6J("icon","down"))},dependencies:[J.J,A._,q.w],encapsulation:2,changeDetection:0})}return ReporterIntegrationExportButton})();const O=["actionItemsContainer"];let L=(()=>{class ReporterIntegrationToolsButton{language;metadata;actionItemsContainer;integrationParams={};actionComponentRefs=[];constructor(e,t){this.language=e,this.metadata=t}get isDisabled(){if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e)if(1==this.integrationParams.activePlugins.kqueryanalizer)return!1;return!0}ngOnChanges(){this.renderActionItems()}ngAfterViewInit(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e)1==this.integrationParams.activePlugins.kqueryanalizer&&this.metadata.addComponent("ReporterIntegrationQueryanalyzerButton",this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}static ɵfac=function(e){return new(e||ReporterIntegrationToolsButton)(c.Y36(v.d),c.Y36(b.Pu))};static ɵcmp=c.Xpm({type:ReporterIntegrationToolsButton,selectors:[["reporter-integration-tools-button"]],viewQuery:function(e,t){if(1&e&&c.Gf(O,5,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[c.TTD],decls:10,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-radius","0","border-left","0","border-right","0",3,"disabled"],["label","LBL_TOOLS"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"button",1)(2,"span")(3,"span"),c._UZ(4,"system-label",2),c.qZA()(),c._UZ(5,"system-button-icon",3),c.qZA(),c.TgZ(6,"div",4)(7,"ul",5),c._UZ(8,"div",null,6),c.qZA()()()),2&e&&(c.xp6(1),c.Q6J("disabled",t.isDisabled),c.xp6(4),c.Q6J("icon","down"))},dependencies:[J.J,A._,q.w],encapsulation:2,changeDetection:0})}return ReporterIntegrationToolsButton})();function U(e,t){if(1&e&&(c.ynx(0),c._uU(1),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Oqu(e.model.data.summary_text)}}const Q=function(){return{displayLabels:!1}};function z(e,t){if(1&e&&c._UZ(0,"object-record-fieldset-horizontal-list",16),2&e){const e=c.oxw();c.Q6J("fieldset",e.fieldset)("system-view-provider",c.DdM(2,Q))}}let E=(()=>{class ReporterDetailViewHeader extends R.Y{language;metadata;model;router;whereConditions={};integrationParams={};showFilters=new c.vpe;constructor(e,t,i,s){super(e,s,i,t),this.language=e,this.metadata=t,this.model=i,this.router=s}toggleFilters(e){this.showFilters.emit(e)}static ɵfac=function(e){return new(e||ReporterDetailViewHeader)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(p.o),c.Y36(y.F0))};static ɵcmp=c.Xpm({type:ReporterDetailViewHeader,selectors:[["reporter-detail-view-header"]],inputs:{whereConditions:"whereConditions",integrationParams:"integrationParams"},outputs:{showFilters:"showFilters"},features:[c.qOj],decls:19,vars:8,consts:[[1,"slds-page-header"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[3,"module","click"],[1,"slds-media__body"],[1,"slds-text-title--caps","slds-line-height--reset"],[3,"click"],[3,"module"],[1,"slds-page-header__title","slds-m-right--small","slds-align-middle","slds-truncate"],[4,"ngIf"],[3,"fieldset","system-view-provider",4,"ngIf"],[1,"slds-m-horizontal--x-small","slds-show--medium","slds-button-group"],[3,"integrationParams"],[3,"whereConditions","filter"],[3,"actionset"],[3,"fieldset","system-view-provider"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"system-icon",4),c.NdJ("click",(function(){return t.goToModule()})),c.qZA(),c.TgZ(5,"div",5)(6,"p",6)(7,"a",7),c.NdJ("click",(function(){return t.goToModule()})),c._UZ(8,"system-label-modulename",8),c.qZA()(),c.TgZ(9,"div")(10,"h1",9),c.YNc(11,U,2,1,"ng-container",10),c.YNc(12,z,1,3,"object-record-fieldset-horizontal-list",11),c.qZA()()()()(),c.TgZ(13,"div",12),c._UZ(14,"reporter-integration-export-button",13)(15,"reporter-integration-tools-button",13),c.TgZ(16,"reporter-filter-button",14),c.NdJ("filter",(function(e){return t.toggleFilters(e)})),c.qZA()(),c._UZ(17,"object-action-container",15),c.qZA(),c._UZ(18,"object-page-header-tags"),c.qZA()),2&e&&(c.xp6(4),c.Q6J("module",t.moduleName),c.xp6(4),c.Q6J("module",t.moduleName),c.xp6(3),c.Q6J("ngIf",!t.fieldset),c.xp6(1),c.Q6J("ngIf",t.fieldset),c.xp6(2),c.Q6J("integrationParams",t.integrationParams),c.xp6(1),c.Q6J("integrationParams",t.integrationParams),c.xp6(1),c.Q6J("whereConditions",t.whereConditions),c.xp6(1),c.Q6J("actionset",t.actionSet))},dependencies:[s.O5,C.S,Z.Z,k.d,I.f,T.M,D.V,Y,P,L],encapsulation:2})}return ReporterDetailViewHeader})();var S=i(3278),B=i(5920),V=i(7514),G=i(5681);function H(e,t){if(1&e&&(c.TgZ(0,"option",6),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.savedfilter_id),c.xp6(1),c.Oqu(e.name)}}let j=(()=>{class ReporterFilterSavedFilters{metadata;model;language;reporterconfig;backend;selectFilterChange=new c.vpe;reportId="";_selectedFilterId="";savedFilters=[];constructor(e,t,i,s,n){this.metadata=e,this.model=t,this.language=i,this.reporterconfig=s,this.backend=n}get selectedFilter(){return this._selectedFilterId}set selectedFilter(e){this._selectedFilterId=e,0==this._selectedFilterId.length?(this.reporterconfig.setDefaultUserFilter(),this.selectFilterChange.emit(null)):(this.selectFilterChange.emit(e),this.savedFilters.some((t=>{if(t.savedfilter_id==e)return this.reporterconfig.setSavedFilter(JSON.parse(t.selectedfilters)),!0})))}get isDisabled(){return 0==this.savedFilters.length}ngOnInit(){this.backend.getRequest(`module/KReports/${this.reportId}/savedfilters`,{assigneduserid:"own"}).subscribe((e=>{this.savedFilters=e}))}pushNewFilter(e){e.selectedfilters=JSON.stringify(e.selectedfilters),e.is_global&&(e.name="(G) "+e.name),this.savedFilters.push(e),this.selectedFilter=e.savedfilter_id}updateFilterData(){this.savedFilters.some((e=>{if(this.selectedFilter==e.savedfilter_id)return e.selectedfilters=JSON.stringify(this.reporterconfig.userFilters),!0}))}static ɵfac=function(e){return new(e||ReporterFilterSavedFilters)(c.Y36(b.Pu),c.Y36(p.o),c.Y36(v.d),c.Y36(u.s),c.Y36(w.y))};static ɵcmp=c.Xpm({type:ReporterFilterSavedFilters,selectors:[["reporter-filter-saved-filters"]],inputs:{reportId:"reportId",_selectedFilterId:"_selectedFilterId"},outputs:{selectFilterChange:"selectFilterChange"},decls:8,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(c.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"select",3),c.NdJ("ngModelChange",(function(e){return t.selectedFilter=e})),c.TgZ(5,"option",4),c._uU(6,"---"),c.qZA(),c.YNc(7,H,2,2,"option",5),c.qZA()()()()()),2&e&&(c.xp6(4),c.Q6J("ngModel",t.selectedFilter)("disabled",t.isDisabled),c.xp6(3),c.Q6J("ngForOf",t.savedFilters))},dependencies:[s.sg,n.YN,n.Kr,n.EJ,n.JJ,n.On],encapsulation:2})}return ReporterFilterSavedFilters})();var K=i(8717),X=i(3411),$=i(8477);function W(e,t){if(1&e&&(c.TgZ(0,"option",11),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e.value),c.xp6(1),c.Oqu(e.display)}}function ee(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-enum",17),2&e){const e=c.oxw(2);c.Q6J("field","value")("wherecondition",e.wherecondition)("isMultiSelect",e.wherecondition.operator.includes("oneof"))}}function te(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-date",18),2&e){const e=c.oxw(2);c.Q6J("field","valuekey")("wherecondition",e.wherecondition)}}function ie(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-text",18),2&e){const e=c.oxw(2);c.Q6J("field","value")("wherecondition",e.wherecondition)}}function se(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-enum",18),2&e){const e=c.oxw(3);c.Q6J("field","valueto")("wherecondition",e.wherecondition)}}function ne(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-date",18),2&e){const e=c.oxw(3);c.Q6J("field","valuetokey")("wherecondition",e.wherecondition)}}function re(e,t){if(1&e&&c._UZ(0,"reporter-filter-item-text",18),2&e){const e=c.oxw(3);c.Q6J("field","valueto")("wherecondition",e.wherecondition)}}function oe(e,t){if(1&e&&(c.TgZ(0,"div",19),c.YNc(1,se,1,2,"reporter-filter-item-enum",15),c.YNc(2,ne,1,2,"reporter-filter-item-date",15),c.YNc(3,re,1,2,"reporter-filter-item-text",15),c.qZA()),2&e){const e=c.oxw(2);c.Q6J("ngSwitch",e.itemType),c.xp6(1),c.Q6J("ngSwitchCase","enum"),c.xp6(1),c.Q6J("ngSwitchCase","date"),c.xp6(1),c.Q6J("ngSwitchCase","text")}}const ae=function(e,t,i){return{"slds-size--1-of-1":e,"slds-size--1-of-2":t,"slds-p-right--xxx-small":i}};function le(e,t){if(1&e&&(c.TgZ(0,"div",12)(1,"div",13),c.YNc(2,ee,1,3,"reporter-filter-item-enum",14),c.YNc(3,te,1,2,"reporter-filter-item-date",15),c.YNc(4,ie,1,2,"reporter-filter-item-text",15),c.qZA(),c.YNc(5,oe,4,4,"div",16),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngSwitch",e.itemType)("ngClass",c.kEZ(6,ae,!e.showValueTo,e.showValueTo,e.showValueTo)),c.xp6(1),c.Q6J("ngSwitchCase","enum"),c.xp6(1),c.Q6J("ngSwitchCase","date"),c.xp6(1),c.Q6J("ngSwitchCase","text"),c.xp6(1),c.Q6J("ngIf",e.showValueTo)}}let de=(()=>{class ReporterFilterItem{language;model;reporterconfig;wherecondition={};constructor(e,t,i){this.language=e,this.model=t,this.reporterconfig=i}getOperators(){let e=[];const t=this.reporterconfig.operatorAssignments[this.wherecondition.type]||"varchar";let i=this.reporterconfig.operatorTypes[t];for(let t of i)e.push({value:t,display:this.language.getLabel("LBL_OP_"+t.toUpperCase())});return e.sort(((e,t)=>e.display>t.display?1:-1)),e}get itemType(){let e="text";switch(this.wherecondition.type){case"enum":case"multienum":case"radioenum":switch(this.wherecondition.operator){case"equals":case"notequal":case"oneof":case"oneofnot":case"oneofnotornull":e="enum"}break;case"date":case"datetime":case"datetimecombo":switch(this.wherecondition.operator){case"before":case"after":case"between":case"equals":e="date"}}return e}get showValue(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>0}get showValueTo(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>1}changeOperator(){this.wherecondition.value="",this.wherecondition.valuekey="",this.wherecondition.valueto="",this.wherecondition.valuetokey=""}static ɵfac=function(e){return new(e||ReporterFilterItem)(c.Y36(v.d),c.Y36(p.o),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterFilterItem,selectors:[["reporter-filter-item"]],inputs:{wherecondition:"wherecondition"},decls:11,vars:4,consts:[[1,"slds-p-bottom--small"],[1,"slds-text-heading--label","slds-p-bottom--xxx-small"],[3,"label"],[1,"slds-form-element","slds-p-vertical--xx-small"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange","change"],["value","ignore"],["label","LBL_OP_IGNORE"],[3,"ngValue",4,"ngFor","ngForOf"],["class","slds-grid slds-p-vertical--xx-small",4,"ngIf"],[3,"ngValue"],[1,"slds-grid","slds-p-vertical--xx-small"],[3,"ngSwitch","ngClass"],[3,"field","wherecondition","isMultiSelect",4,"ngSwitchCase"],[3,"field","wherecondition",4,"ngSwitchCase"],["class","slds-size--1-of-2 slds-p-left--xxx-small",3,"ngSwitch",4,"ngIf"],[3,"field","wherecondition","isMultiSelect"],[3,"field","wherecondition"],[1,"slds-size--1-of-2","slds-p-left--xxx-small",3,"ngSwitch"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1),c._UZ(2,"system-label",2),c.qZA(),c.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"select",6),c.NdJ("ngModelChange",(function(e){return t.wherecondition.operator=e}))("change",(function(){return t.changeOperator()})),c.TgZ(7,"option",7),c._UZ(8,"system-label",8),c.qZA(),c.YNc(9,W,2,2,"option",9),c.qZA()()()(),c.YNc(10,le,6,10,"div",10),c.qZA()),2&e&&(c.xp6(2),c.Q6J("label",t.wherecondition.label),c.xp6(4),c.Q6J("ngModel",t.wherecondition.operator),c.xp6(3),c.Q6J("ngForOf",t.getOperators()),c.xp6(1),c.Q6J("ngIf",t.showValue))},dependencies:[s.mk,s.sg,s.O5,s.RF,s.n9,n.YN,n.Kr,n.EJ,n.JJ,n.On,A._,K.I,X.i,$.h],encapsulation:2})}return ReporterFilterItem})();const ce=["popover"],pe=["savedFiltersContainer"];function ue(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",28)(1,"reporter-filter-saved-filters",29,30),c.NdJ("selectFilterChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.setSelectedFilterId(t))})),c.qZA()()}if(2&e){const e=c.oxw();c.xp6(1),c.Q6J("reportId",e.model.id)}}function he(e,t){if(1&e&&c._UZ(0,"reporter-filter-item",31),2&e){const e=t.$implicit;c.Q6J("wherecondition",e)}}function ge(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",45)(1,"system-checkbox",46),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw(2);return c.KtG(i.filter.is_global=t)})),c._UZ(2,"system-label",47),c.qZA()()}if(2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngModel",e.filter.is_global)}}function fe(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",32)(1,"div",33)(2,"fieldset",34)(3,"div",35)(4,"label",36),c._UZ(5,"system-label",37),c.qZA(),c.TgZ(6,"div",38)(7,"input",39),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.filter.name=t)})),c.qZA()()(),c.YNc(8,ge,3,1,"div",40),c.qZA(),c.TgZ(9,"div",41)(10,"button",42),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.confirmSave())})),c._UZ(11,"system-label",19),c.qZA(),c.TgZ(12,"button",43),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.closePopover())})),c._UZ(13,"system-label",44),c.qZA()()()()}if(2&e){const e=c.oxw();c.Q6J("@animatepopover",void 0),c.xp6(7),c.Q6J("ngModel",e.filter.name),c.xp6(1),c.Q6J("ngIf",e.isAdmin)}}const me=[(0,h.X$)("animatepopover",[(0,h.eR)(":enter",[(0,h.oB)({opacity:0}),(0,h.jt)(".25s",(0,h.oB)({opacity:1}))]),(0,h.eR)(":leave",[(0,h.oB)({opacity:"1"}),(0,h.jt)(".25s",(0,h.oB)({opacity:0}))])])];let ve=(()=>{class ReporterFilterPanel{model;language;elementRef;toast;backend;session;reporterconfig;popover;savedFiltersComponent;filterapplied=new c.vpe;integrationparams={};selectedFilterId;showPopover=!1;filter={};constructor(e,t,i,s,n,r,o){this.model=e,this.language=t,this.elementRef=i,this.toast=s,this.backend=n,this.session=r,this.reporterconfig=o}get isAdmin(){return!!this.session.authData.admin}get whereConditions(){return this.reporterconfig.userFilters}get popoverStyle(){let e=this.elementRef.nativeElement.getBoundingClientRect(),t=this.popover.element.nativeElement.getBoundingClientRect();return{position:"fixed",top:e.top+(e.height-t.height)/2+"px",left:e.left-t.width+"px"}}get displaySavedFilters(){return!!this.integrationparams.activePlugins&&!!this.integrationparams.activePlugins.ksavedfilters}openPopover(){this.showPopover=!0,this.initializeFilter()}closePopover(){this.showPopover=!1,this.initializeFilter()}initializeFilter(){this.filter={savedfilter_id:this.model.generateGuid(),name:"",isNew:!0,is_global:!1}}applyFilter(){this.filterapplied.emit(!0),this.reporterconfig.refresh()}setSelectedFilterId(e){this.selectedFilterId=e}handleSave(){if(!this.selectedFilterId)return this.openPopover();this.saveFilter(this.selectedFilterId)}saveFilter(e,t){let i={selectedfilters:{...this.reporterconfig.userFilters}};i&&(i={...t,...i}),this.backend.postRequest(`module/KReports/${this.model.id}/savedfilter/${e}`,[],i).subscribe((e=>{e&&e.success?(this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED"),"success"),this.savedFiltersComponent&&(t?this.savedFiltersComponent.pushNewFilter(i):this.savedFiltersComponent.updateFilterData())):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}saveFilterAs(){this.selectedFilterId&&this.openPopover()}confirmSave(){this.selectedFilterId=void 0,this.saveFilter(this.filter.savedfilter_id,this.filter),this.closePopover()}static ɵfac=function(e){return new(e||ReporterFilterPanel)(c.Y36(p.o),c.Y36(v.d),c.Y36(c.SBq),c.Y36(S.A),c.Y36(w.y),c.Y36(B.n),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterFilterPanel,selectors:[["reporter-filter-panel"]],viewQuery:function(e,t){if(1&e&&(c.Gf(ce,7,c.s_b),c.Gf(pe,5)),2&e){let e;c.iGM(e=c.CRH())&&(t.popover=e.first),c.iGM(e=c.CRH())&&(t.savedFiltersComponent=e.first)}},inputs:{integrationparams:"integrationparams"},outputs:{filterapplied:"filterapplied"},decls:30,vars:8,consts:[[1,"slds-panel","slds-grid","slds-grid_vertical","slds-nowrap","slds-panel_filters","slds-height_full",2,"width","500px","box-shadow","0 10px 10px #888"],[1,"slds-form","slds-form_stacked","slds-grow","slds-scrollable_y","slds-grid","slds-grid_vertical"],[1,"slds-filters"],[1,"slds-filters__header","slds-grid","slds-has-divider_bottom-space"],[1,"slds-align-middle","slds-text-heading_small"],["label","LBL_FILTER"],[1,"slds-button-group","slds-col_bump-left"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_APPLY"],["system-dropdown-trigger","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click","slds-button_last"],["aria-haspopup","true",1,"slds-button","slds-button_icon","slds-button_icon-border-filled",3,"disabled","title"],["icon","down"],[1,"slds-assistive-text"],["label","LBL_MORE"],[1,"slds-dropdown","slds-dropdown_right","slds-dropdown_actions"],["role","menu",1,"slds-dropdown__list"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],[1,"slds-truncate"],["label","LBL_SAVE"],["href","javascript:void(0);","role","menuitem","tabindex","-1",3,"click"],["label","LBL_SAVE_AS"],["class","slds-filters__header slds-has-divider_bottom-space",4,"ngIf"],[1,"slds-filters__body"],[3,"wherecondition",4,"ngFor","ngForOf"],[3,"ngStyle"],["popover",""],["class","slds-popover slds-nubbin--right","role","dialog",4,"ngIf"],[1,"slds-filters__header","slds-has-divider_bottom-space"],[3,"reportId","selectFilterChange"],["savedFiltersContainer",""],[3,"wherecondition"],["role","dialog",1,"slds-popover","slds-nubbin--right"],[1,"slds-popover__body"],[1,"slds-form--stacked"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_NAME"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["class","slds-m-top--small",4,"ngIf"],[1,"slds-text-align--right","slds-p-top--x-small"],["type","button",1,"slds-button","slds-button--brand","slds-button-space-left",3,"click"],["type","button",1,"slds-button","slds-button--neutral","slds-button-space-left",3,"click"],["label","LBL_CLOSE"],[1,"slds-m-top--small"],[3,"ngModel","ngModelChange"],["label","LBL_GLOBAL"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),c._UZ(5,"system-label",5),c.qZA(),c.TgZ(6,"div",6)(7,"button",7),c.NdJ("click",(function(){return t.applyFilter()})),c._UZ(8,"system-label",8),c.qZA(),c.TgZ(9,"div",9)(10,"button",10),c._UZ(11,"system-button-icon",11),c.TgZ(12,"span",12),c._UZ(13,"system-label",13),c.qZA()(),c.TgZ(14,"div",14)(15,"ul",15)(16,"li",16)(17,"a",17),c.NdJ("click",(function(){return t.handleSave()})),c.TgZ(18,"span",18),c._UZ(19,"system-label",19),c.qZA()()(),c.TgZ(20,"li",16)(21,"a",20),c.NdJ("click",(function(){return t.saveFilterAs()})),c.TgZ(22,"span",18),c._UZ(23,"system-label",21),c.qZA()()()()()()()(),c.YNc(24,ue,3,1,"div",22),c.TgZ(25,"div",23),c.YNc(26,he,1,1,"reporter-filter-item",24),c.qZA()()()(),c.TgZ(27,"div",25,26),c.YNc(29,fe,14,3,"div",27),c.qZA()),2&e&&(c.xp6(10),c.Q6J("disabled",!t.displaySavedFilters)("title",t.language.getLabel("LBL_MORE")),c.xp6(12),c.ekj("slds-disabled-text",!t.selectedFilterId),c.xp6(2),c.Q6J("ngIf",t.displaySavedFilters),c.xp6(2),c.Q6J("ngForOf",t.whereConditions),c.xp6(1),c.Q6J("ngStyle",t.popoverStyle),c.xp6(2),c.Q6J("ngIf",t.showPopover))},dependencies:[s.sg,s.O5,s.PC,n.Fj,n.JJ,n.On,J.J,V.U,A._,G.l,j,de],encapsulation:2,data:{animation:me}})}return ReporterFilterPanel})();var be=i(4021);const we=["vizcontainer"];function ye(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",3)(1,"div",4),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.openReport())})),c._uU(2),c.qZA(),c.TgZ(3,"button",5),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.reload())})),c._UZ(4,"system-button-icon",6),c.qZA()()}if(2&e){const e=c.oxw();c.xp6(2),c.Oqu(e.model.data.name)}}let _e=(()=>{class ReporterDetailVisualization{reporterconfig;metadata;model;toast;backend;cdRef;httpRequestsRefID=window._.uniqueId("reporter_visualization_http_ref_");vizcontainer;parentModule="";parentId="";displayEmbedded=!1;loading=!0;vizData={};chartComponent;subscriptions=new f.w0;constructor(e,t,i,s,n,r){this.reporterconfig=e,this.metadata=t,this.model=i,this.toast=s,this.backend=n,this.cdRef=r,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getVisualization():this.handleCancel()}}))}ngAfterViewInit(){this.getVisualization()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}reload(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null),this.getVisualization()}getVisualization(){this.loading=!0,this.reporterconfig.isLoading.visualization=!0,this.cdRef.detectChanges();let e={};this.parentModule&&this.parentId&&(e.parentbeanId=this.parentId,e.parentbeanModule=this.parentModule);let t=[];for(let e of this.reporterconfig.userFilters)t.push({fieldid:e.fieldid,operator:e.operator,value:e.value,valuekey:e.valuekey,valueto:e.valueto,valuetokey:e.valuetokey});e.whereConditions=JSON.stringify(t),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.getRequest("module/KReports/"+this.model.id+"/visualization",e,this.httpRequestsRefID).subscribe({next:e=>{this.vizData=e,this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.renderVisualization()},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges()}})}get visualizationStyle(){return{height:this.displayEmbedded?"calc(100% - 36px)":"100%"}}renderVisualization(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null);for(let e of this.vizData){let t="";switch(e.plugin){case"highcharts":t="ReporterDetailVisualizationHighcharts";break;case"googlecharts":t="ReporterDetailVisualizationGooglecharts";break;case"googlemaps":t="ReporterDetailVisualizationGoogleMaps"}""!=t&&this.metadata.addComponent(t,this.vizcontainer).subscribe((t=>{this.chartComponent=t,t.instance.vizdata=e,t.changeDetectorRef.detectChanges()}))}}openReport(){this.model.goDetail()}handleCancel(){this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}static ɵfac=function(e){return new(e||ReporterDetailVisualization)(c.Y36(u.s),c.Y36(b.Pu),c.Y36(p.o),c.Y36(S.A),c.Y36(w.y),c.Y36(c.sBO))};static ɵcmp=c.Xpm({type:ReporterDetailVisualization,selectors:[["reporter-detail-visualization"]],viewQuery:function(e,t){if(1&e&&c.Gf(we,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.vizcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayEmbedded:"displayEmbedded"},decls:4,vars:4,consts:[["class","slds-grid slds-grid--align-spread slds-p-horizontal--xx-small slds-p-vertical--x-small",4,"ngIf"],[1,"slds-is-relative","slds-size--1-of-1",3,"ngStyle","cancellable","system-overlay-loading-spinner","onCancel"],["vizcontainer",""],[1,"slds-grid","slds-grid--align-spread","slds-p-horizontal--xx-small","slds-p-vertical--x-small"],[1,"slds-text-heading_small","slds-text-link_faux",3,"click"],[1,"slds-button","slds-button--icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&(c.YNc(0,ye,5,1,"div",0),c.TgZ(1,"div",1),c.NdJ("onCancel",(function(){return t.handleCancel()})),c._UZ(2,"div",null,2),c.qZA()),2&e&&(c.Q6J("ngIf",t.displayEmbedded),c.xp6(1),c.Q6J("ngStyle",t.visualizationStyle)("cancellable",!0)("system-overlay-loading-spinner",t.loading))},dependencies:[s.O5,s.PC,J.J,be._],encapsulation:2,changeDetection:0})}return ReporterDetailVisualization})();const xe=["presentationContainer"];function Fe(e,t){if(1&e&&(c.TgZ(0,"div",7),c._UZ(1,"reporter-detail-visualization"),c.qZA()),2&e){const e=c.oxw();c.Udp("height",e.visualizationHeight,"px")}}function Re(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"reporter-filter-panel",8),c.NdJ("filterapplied",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.filterApplied())})),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("@displayfilter",void 0)("integrationparams",e.integrationParams)}}const Ce=[(0,h.X$)("displayfilter",[(0,h.eR)(":enter",[(0,h.oB)({width:"0px",overflow:"hidden"}),(0,h.jt)(".5s",(0,h.oB)({width:"*"})),(0,h.oB)({overflow:"unset"})]),(0,h.eR)(":leave",[(0,h.oB)({overflow:"hidden"}),(0,h.jt)(".5s",(0,h.oB)({width:"0px"}))])])];let Ze=(()=>{class ReporterDetailView{broadcast;language;metadata;injector;model;backend;activatedRoute;navigationtab;router;reporterconfig;cdRef;view;presentationContainer;presentationComponentRef=void 0;hasVisualization=!1;visualizationHeight=0;whereConditions={};integrationParams={};showFilters=!1;subscriptions=new f.w0;constructor(e,t,i,s,n,r,o,a,l,d,c,p){this.broadcast=e,this.language=t,this.metadata=i,this.injector=s,this.model=n,this.backend=r,this.activatedRoute=o,this.navigationtab=a,this.router=l,this.reporterconfig=d,this.cdRef=c,this.view=p,this.subscribeToBroadcast()}ngOnInit(){this.setNavigationTabInfos(this.language.getModuleName(this.model.module)),this.setModelData(),this.view.isEditable=this.metadata.checkModuleAcl(this.model.module,"edit")}ngOnDestroy(){this.subscriptions.unsubscribe()}subscribeToBroadcast(){this.subscriptions.add(this.broadcast.message$.subscribe((e=>{"model.save"==e.messagetype&&e.messagedata.module==this.model.module&&e.messagedata.id==this.model.id&&(this.showFilters=!1,this.reporterconfig.resetUserFilters(),this.whereConditions=e.messagedata.data.whereconditions,this.setIntegrationParams(e.messagedata.data.integration_params),this.setVisualizationProperties(e.messagedata.data.visualization_params),this.renderPresentation(e.messagedata.data.presentation_params),this.reporterconfig.refresh(),this.cdRef.detectChanges())})))}setNavigationTabInfos(e){this.navigationtab.setTabInfo({displayname:e,displaymodule:this.model.module})}setModelData(){this.model.module=this.navigationtab.activeRoute.params.module,this.model.id=this.navigationtab.activeRoute.params.id,this.model.getData(!0,"detailview",!0,!0).subscribe((e=>{this.setNavigationTabInfos(e.summary_text),this.setVisualizationProperties(e.visualization_params),this.reporterconfig.resetUserFilters(),this.whereConditions=e.whereconditions,this.renderPresentation(e.presentation_params),this.setIntegrationParams(e.integration_params),this.cdRef.detectChanges()}))}setIntegrationParams(e){this.integrationParams=void 0,e&&(this.integrationParams=e)}setVisualizationProperties(e){this.hasVisualization=!1,e&&e&&e.layout&&"-"!=e.layout&&(this.hasVisualization=!0,this.visualizationHeight=e.chartheight?e.chartheight:300)}renderPresentation(e){if(this.presentationComponentRef&&(this.presentationComponentRef.destroy(),this.presentationComponentRef=void 0),!e)return;let t="";switch(e.plugin){case"standard":t="ReporterDetailPresentationStandard";break;case"grouped":t="ReporterDetailPresentationGrouped";break;case"standardws":t="ReporterDetailPresentationStandardWS";break;case"tree":t="ReporterDetailPresentationTree";break;case"pivot":t="ReporterDetailPresentationPivot"}""!=t&&this.metadata.addComponent(t,this.presentationContainer).subscribe((e=>{this.presentationComponentRef=e,this.presentationComponentRef.changeDetectorRef.detectChanges()}))}toggleFilters(e){this.showFilters=e}filterApplied(){this.showFilters=!1}static ɵfac=function(e){return new(e||ReporterDetailView)(c.Y36(m.f),c.Y36(v.d),c.Y36(b.Pu),c.Y36(c.zs3),c.Y36(p.o),c.Y36(w.y),c.Y36(y.gz),c.Y36(x.d),c.Y36(y.F0),c.Y36(u.s),c.Y36(c.sBO),c.Y36(g.e))};static ɵcmp=c.Xpm({type:ReporterDetailView,selectors:[["reporter-detilview"]],viewQuery:function(e,t){if(1&e&&c.Gf(xe,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.presentationContainer=e.first)}},features:[c._Bn([g.e,p.o,u.s])],decls:9,vars:4,consts:[[1,"slds-grid","slds-grid--vertical"],[3,"integrationParams","whereConditions","showFilters"],[1,"slds-is-relative","slds-grow",2,"min-height","0"],["class","slds-size--1-of-1",3,"height",4,"ngIf"],["system-to-bottom-noscroll",""],["presentationContainer",""],["class","slds-is-absolute","style","z-index: 100; right: 0; top: 0; bottom: 0",3,"integrationparams","filterapplied",4,"ngIf"],[1,"slds-size--1-of-1"],[1,"slds-is-absolute",2,"z-index","100","right","0","top","0","bottom","0",3,"integrationparams","filterapplied"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div")(2,"reporter-detail-view-header",1),c.NdJ("showFilters",(function(e){return t.toggleFilters(e)})),c.qZA()(),c.TgZ(3,"div",2),c.YNc(4,Fe,2,2,"div",3),c.TgZ(5,"div",4),c._UZ(6,"div",null,5),c.qZA(),c.YNc(8,Re,1,2,"reporter-filter-panel",6),c.qZA()()),2&e&&(c.xp6(2),c.Q6J("integrationParams",t.integrationParams)("whereConditions",t.whereConditions),c.xp6(2),c.Q6J("ngIf",t.hasVisualization),c.xp6(4),c.Q6J("ngIf",t.showFilters))},dependencies:[s.O5,F.t,E,ve,_e],encapsulation:2,data:{animation:Ce},changeDetection:0})}return ReporterDetailView})(),ke=(()=>{class ReporterDetailViewRefreshButton{language;reporterconfig;subscription=new f.w0;constructor(e,t){this.language=e,this.reporterconfig=t}ngOnDestroy(){this.subscription.unsubscribe()}execute(){this.reporterconfig.isLoading.visualization||this.reporterconfig.isLoading.presentation?this.reporterconfig.cancelRequests():this.reporterconfig.refresh()}static ɵfac=function(e){return new(e||ReporterDetailViewRefreshButton)(c.Y36(v.d),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterDetailViewRefreshButton,selectors:[["reporter-detail-view-refresh-button"]],decls:2,vars:1,consts:[[3,"label"]],template:function(e,t){1&e&&(c.TgZ(0,"span"),c._UZ(1,"system-label",0),c.qZA()),2&e&&(c.xp6(1),c.Q6J("label",t.reporterconfig.isLoading.visualization||t.reporterconfig.isLoading.presentation?"LBL_CANCEL":"LBL_REFRESH"))},dependencies:[A._],encapsulation:2})}return ReporterDetailViewRefreshButton})(),Ie=(()=>{class ReporterDetailViewEditButton{language;router;model;constructor(e,t,i){this.language=e,this.router=t,this.model=i}execute(){this.disabled||this.router.navigate(["/module/KReports/designer/"+this.model.id])}get disabled(){return!this.model.checkAccess("edit")||(this.model.isEditing||this.model.isSaving)}static ɵfac=function(e){return new(e||ReporterDetailViewEditButton)(c.Y36(v.d),c.Y36(y.F0),c.Y36(p.o))};static ɵcmp=c.Xpm({type:ReporterDetailViewEditButton,selectors:[["reporter-detail-view-edit-button"]],decls:2,vars:0,consts:[["label","LBL_EDIT"]],template:function(e,t){1&e&&(c.TgZ(0,"span"),c._UZ(1,"system-label",0),c.qZA())},dependencies:[A._],encapsulation:2})}return ReporterDetailViewEditButton})();var Te=i(429),De=i(5336),Je=i(6257),Ae=i(7832),Me=i(6434),Ye=i(1512),qe=i(7982),Ne=i(4044),Pe=i(34),Oe=i(8859),Le=i(151),Ue=i(2995),Qe=i(1790);const ze=function(e,t){return{record:e,field:t}};function Ee(e,t){if(1&e&&(c.ynx(0),c.TgZ(1,"div",2),c._UZ(2,"system-dynamic-component",3),c.qZA(),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("module",e.recordModule)("id",e.recordId),c.xp6(1),c.Q6J("component",e.fieldType)("componentattributes",c.WLB(4,ze,e.record,e.field))}}function Se(e,t){if(1&e&&c._UZ(0,"system-dynamic-component",3),2&e){const e=c.oxw();c.Q6J("component",e.fieldType)("componentattributes",c.WLB(2,ze,e.record,e.field))}}let Be=(()=>{class ReporterFieldContainer{metadata;record={};value="";field={};recordModule;recordId;fieldType;constructor(e){this.metadata=e}ngOnInit(){this.initializeRecord(),this.buildLinkInfo(),this.determineFieldType()}initializeRecord(){this.value&&_.isEmpty(this.record)&&(this.record={},this.record[this.field.fieldid]=this.value,this.record[this.field.fieldid+"_val"]=this.value)}buildLinkInfo(){if("yes"==this.field.link&&this.record)if(this.field.linkinfo&&this.field.linkinfo[this.record.unionid?this.record.unionid:"root"])this.recordModule=this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].module,this.recordId=this.record[this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].idfield];else if(this.hasPathField){let e=this.fieldPathInfo.path.split("::").pop().split(":"),t=this.metadata.getFieldDefs(e[1],e[2]);this.recordModule=t.module,this.recordId=this.fieldPathInfo.id}else this.recordModule=this.record.sugarRecordModule,this.recordId=this.record.sugarRecordId}get fieldPathInfo(){let e=this.field.path.split("::");e.pop();let t,i=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==i){t={},t.path=i,t.id=this.record[e.replace("path","id")];break}return t}get hasPathField(){let e=this.field.path.split("::");if(e.pop(),1==e.length)return!1;let t=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==t)return!0;return!1}determineFieldType(){if(this.field.component)this.fieldType=this.field.component;else switch(this.field.type){case"percentage":this.fieldType="ReporterFieldPercentage";break;case"currency":case"currencyint":this.fieldType="ReporterFieldCurrency";break;case"enum":case"multienum":case"radioenum":this.fieldType="ReporterFieldEnum";break;case"datetimecombo":case"datetime":this.fieldType="ReporterFieldDateTime";break;case"date":this.fieldType="ReporterFieldDate";break;case"text":this.fieldType="ReporterFieldText";break;case"category":this.fieldType="ReporterFieldCategoryTree";break;default:this.fieldType="ReporterFieldStandard"}}static ɵfac=function(e){return new(e||ReporterFieldContainer)(c.Y36(b.Pu))};static ɵcmp=c.Xpm({type:ReporterFieldContainer,selectors:[["reporter-field-container"]],inputs:{record:"record",value:"value",field:"field"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nolink",""],["system-model-popover","",1,"slds-text-link_reset",3,"module","id"],[3,"component","componentattributes"]],template:function(e,t){if(1&e&&(c.YNc(0,Ee,3,7,"ng-container",0),c.YNc(1,Se,1,5,"ng-template",null,1,c.W1O)),2&e){const e=c.MAs(2);c.Q6J("ngIf","yes"==t.field.link)("ngIfElse",e)}},dependencies:[s.O5,Ue.T,Qe.g],encapsulation:2,changeDetection:0})}return ReporterFieldContainer})();function Ve(e,t){if(1&e&&c._UZ(0,"system-utility-icon",15),2&e){const e=c.oxw(3);c.Udp("transform","desc"==e.sortData.sortDirection?"rotate(180deg)":"none")}}function Ge(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"a",11),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw().$implicit,i=c.oxw();return c.KtG(i.toggleSort(t))})),c.TgZ(1,"div",12),c._UZ(2,"system-label",13),c.qZA(),c.YNc(3,Ve,1,2,"system-utility-icon",14),c.qZA()}if(2&e){const e=c.oxw().$implicit,t=c.oxw();c.Q6J("ngClass",t.fieldsDisplayClasses[e.fieldid]),c.xp6(2),c.Q6J("label",e.name),c.xp6(1),c.Q6J("ngIf",!!t.sortData.sortDirection)}}function He(e,t){if(1&e&&c._UZ(0,"system-utility-icon",15),2&e){const e=c.oxw(2).$implicit;c.Udp("transform","desc"==e.sort?"rotate(180deg)":"none")}}function je(e,t){if(1&e&&(c.TgZ(0,"div",16)(1,"div",17),c._UZ(2,"system-label",13),c.qZA(),c.YNc(3,He,1,2,"system-utility-icon",14),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(2),c.Q6J("label",e.name),c.xp6(1),c.Q6J("ngIf",!!e.sort&&"-"!=e.sort)}}function Ke(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"th",8),c.NdJ("system-resize",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.onresize())})),c.YNc(1,Ge,4,3,"a",9),c.YNc(2,je,4,2,"ng-template",null,10,c.W1O),c.qZA()}if(2&e){const e=t.$implicit,i=c.MAs(3),s=c.oxw();c.Udp("width",s.fieldsData[e.fieldid].width,"%"),c.Q6J("ngClass",s.fieldsDisplayClasses[e.fieldid])("resizeid",e.fieldid),c.xp6(1),c.Q6J("ngIf",!!e.sort&&"sortable"==e.sort)("ngIfElse",i)}}function Xe(e,t){if(1&e&&(c.TgZ(0,"td",21),c._UZ(1,"reporter-field-container",22),c.qZA()),2&e){const e=t.$implicit,i=c.oxw().$implicit;c.xp6(1),c.Q6J("field",e)("record",i)}}function $e(e,t){if(1&e&&(c.TgZ(0,"tr",19),c.YNc(1,Xe,2,2,"td",20),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",e.displayFields)("ngForTrackBy",e.trackByFn)}}function We(e,t){if(1&e&&(c.ynx(0),c.YNc(1,$e,2,2,"tr",18),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngForOf",e.presData.records)("ngForTrackBy",e.trackByFn)}}function et(e,t){1&e&&(c.TgZ(0,"div",23)(1,"h2",24),c._UZ(2,"system-label",25),c.qZA()())}function tt(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",36),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw(2);return c.KtG(t.saveLayout())})),c._UZ(1,"system-button-icon",37),c.qZA()}}function it(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",26)(1,"div",27),c._uU(2),c.qZA(),c.TgZ(3,"div",27)(4,"button",28),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.firstPage())})),c._UZ(5,"system-custom-icon",29),c.qZA(),c.TgZ(6,"button",28),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.prevPage())})),c._UZ(7,"system-button-icon",30),c.qZA(),c.TgZ(8,"button",28),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.nextPage())})),c._UZ(9,"system-button-icon",31),c.qZA(),c.TgZ(10,"button",28),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.lastPage())})),c._UZ(11,"system-custom-icon",32),c.qZA(),c.TgZ(12,"button",33),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.selectFields())})),c._UZ(13,"system-button-icon",34),c.qZA(),c.YNc(14,tt,2,0,"button",35),c.qZA()()}if(2&e){const e=c.oxw();c.xp6(2),c.AsE(" ",e.displayRecords," of ",e.presData.count," "),c.xp6(2),c.Q6J("disabled",e.prevDisabled),c.xp6(2),c.Q6J("disabled",e.prevDisabled),c.xp6(2),c.Q6J("disabled",e.nextDisabled),c.xp6(2),c.Q6J("disabled",e.nextDisabled),c.xp6(4),c.Q6J("ngIf",e.canSave)}}let st=(()=>{class ReporterDetailPresentationStandard{language;model;modal;injector;backend;reporterconfig;cdRef;toast;httpRequestsRefID=window._.uniqueId("reporter_presentation_http_ref_");presParams={};presData={};fieldsData={};fieldsDisplayClasses={};totalWidth=0;showFooter=!0;isLoading=!0;sortData={sortField:"",sortDirection:""};displayFields=[];resizeElements;currentPage=1;subscriptions=new f.w0;constructor(e,t,i,s,n,r,o,a){this.language=e,this.model=t,this.modal=i,this.injector=s,this.backend=n,this.reporterconfig=r,this.cdRef=o,this.toast=a,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getPresentation():this.handleCancel()}}))}get listEntries(){try{return this.presParams.pluginData.standardViewProperties.listEntries}catch(e){return 25}}get displayRecords(){let e=(this.currentPage-1)*this.listEntries+1,t=this.currentPage*this.listEntries;return e+" - "+(t>this.presData.count?this.presData.count:t)}get canSave(){return this.model.checkAccess("edit")}get prevDisabled(){return this.currentPage<=1}get nextDisabled(){return this.currentPage*this.listEntries>=this.presData.count}ngOnInit(){this.presParams=this.model.getField("presentation_params")}ngAfterViewInit(){this.getPresentation()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}getPresentation(){this.isLoading=!0,this.reporterconfig.isLoading.presentation=!0,this.cdRef.detectChanges();let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});let t={start:(this.currentPage-1)*this.listEntries,limit:this.listEntries,whereConditions:JSON.stringify(e),parentbeanId:this.model.parentBeanId,parentbeanModule:this.model.parentBeanModule,sort:void 0};this.sortData.sortField&&(t.sort=JSON.stringify([{direction:this.sortData.sortDirection.toUpperCase(),property:this.sortData.sortField}])),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.postRequest(`module/KReports/${this.model.id}/presentation/dynamicoptions`,{},t,this.httpRequestsRefID).subscribe({next:e=>{if(this.presData=[],this.cdRef.detectChanges(),e){if(0==this.totalWidth)for(let t of e.reportmetadata.fields)this.fieldsData[t.fieldid]=t,this.fieldsDisplayClasses[t.fieldid]=this.generateFieldDisplayClass(t),this.totalWidth+=t.width;this.presData=e,this.setDisplayFields(),this.processPresData(),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}})}processPresData(){}trackByFn(e,t){return t.id}setDisplayFields(){this.displayFields=[],this.cdRef.detectChanges(),this.presData.reportmetadata&&this.presData.reportmetadata.fields&&(this.displayFields=this.presData.reportmetadata.fields.filter((e=>"yes"==e.display)).sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.cdRef.detectChanges())}generateFieldDisplayClass(e){let t=[];switch(e.sort&&"-"!=e.sort&&(t.push("slds-is-sortable"),e.fieldid==this.sortData.sortField&&(t.push("slds-is-sorted"),"asc"==this.sortData.sortDirection&&t.push("slds-is-sorted_asc"))),e.type){case"currency":case"currencyint":t.push("slds-grid--align-end");break;case"enum":case"multienum":case"radioenum":t.push("slds-grid--align-center")}return t.join(" ")}toggleSort(e){"sortable"==e.sort&&(this.sortData.sortField==e.fieldid?("asc"==this.sortData.sortDirection?this.sortData.sortDirection="desc":(this.sortData.sortField="",this.sortData.sortDirection=""),this.getPresentation()):(this.sortData.sortField=e.fieldid,this.sortData.sortDirection="asc",this.getPresentation()))}onresize(){let e={},t=0;this.resizeElements.forEach((i=>{let s=i.getElementWidth();t+=s,e[i.resizeid]=i.getElementWidth()}));for(let i in this.fieldsData)this.fieldsData.hasOwnProperty(i)&&(this.fieldsData[i].width=Math.round(e[i]/t*100));this.totalWidth=100}saveLayout(){if(this.model.checkAccess("edit")){let e=[];for(let t of this.model.getField("listfields").filter((e=>"hidden"!=e.display)))e.push({dataIndex:t.fieldid,width:this.fieldsData[t.fieldid].width,sequence:parseInt(this.fieldsData[t.fieldid].sequence,10),isHidden:"yes"!=this.fieldsData[t.fieldid].display});this.backend.postRequest("module/KReports/"+this.model.id+"/layout",{},{layout:e}).subscribe((e=>{e.success&&this.toast.sendToast("Layout saved")}))}}firstPage(){this.currentPage=1,this.getPresentation()}prevPage(){this.currentPage--,this.getPresentation()}nextPage(){this.currentPage++,this.getPresentation()}lastPage(){this.currentPage=Math.ceil(this.presData.count/this.listEntries),this.getPresentation()}selectFields(){this.modal.openModal("ReporterDetailSelectFieldsModal",!0,this.injector).subscribe((e=>{e.instance.presentationFields=this.presData.reportmetadata.fields,e.instance.dataChanged$.subscribe((e=>{e&&this.setDisplayFields()}))}))}handleCancel(){this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.cdRef.detectChanges()}static ɵfac=function(e){return new(e||ReporterDetailPresentationStandard)(c.Y36(v.d),c.Y36(p.o),c.Y36(Ne.o),c.Y36(c.zs3),c.Y36(w.y),c.Y36(u.s),c.Y36(c.sBO),c.Y36(S.A))};static ɵcmp=c.Xpm({type:ReporterDetailPresentationStandard,selectors:[["reporter-detail-presentation-standard"]],viewQuery:function(e,t){if(1&e&&c.Gf(qe.h,5),2&e){let e;c.iGM(e=c.CRH())&&(t.resizeElements=e)}},decls:11,vars:7,consts:[[1,"slds-height_full","slds-grid","slds-grid--vertical"],[1,"slds-scrollable--y","slds-grow","slds-grid","slds-grid--vertical",2,"min-height","0",3,"cancellable","system-overlay-loading-spinner","onCancel"],[1,"slds-table","slds-table_bordered","slds-table--fixed-layout","slds-table--header-fixed"],[1,"slds-text-title--caps"],["scope","col","class","slds-resizable",3,"ngClass","width","resizeid","system-resize",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","slds-p-around--medium slds-align--absolute-center slds-grow","style","min-height: 0",4,"ngIf"],["class","slds-p-vertical--x-small slds-grid slds-grid_vertical-align-center slds-grid_align-spread",4,"ngIf"],["scope","col",1,"slds-resizable",3,"ngClass","resizeid","system-resize"],["href","javascript:void(0);","class","slds-th__action slds-text-link--reset slds-grid",3,"ngClass","click",4,"ngIf","ngIfElse"],["notsortable",""],["href","javascript:void(0);",1,"slds-th__action","slds-text-link--reset","slds-grid",3,"ngClass","click"],[1,"slds-truncate","slds-p-vertical--xx-small"],[3,"label"],["icon","arrowdown","size","x-small",3,"transform",4,"ngIf"],["icon","arrowdown","size","x-small"],[1,"slds-th__action","slds-grid"],[1,"slds-truncate"],["style","vertical-align: top;",4,"ngFor","ngForOf","ngForTrackBy"],[2,"vertical-align","top"],["scope","row",4,"ngFor","ngForOf","ngForTrackBy"],["scope","row"],[3,"field","record"],[1,"slds-p-around--medium","slds-align--absolute-center","slds-grow",2,"min-height","0"],[1,"slds-text-heading--small"],["label","LBL_NO_ENTRIES"],[1,"slds-p-vertical--x-small","slds-grid","slds-grid_vertical-align-center","slds-grid_align-spread"],[1,"slds-p-horizontal--medium"],[1,"slds-button","slds-button_icon",3,"disabled","click"],["icon","chevrondoubleleft","size","x-small"],["icon","chevronleft"],["icon","chevronright"],["icon","chevrondoubleright","size","x-small"],["system-title","LBL_CHOOSE_FIELDS",1,"slds-button","slds-button_icon",3,"click"],["icon","settings"],["class","slds-button slds-button_icon","system-title","LBL_SAVE_LAYOUT",3,"click",4,"ngIf"],["system-title","LBL_SAVE_LAYOUT",1,"slds-button","slds-button_icon",3,"click"],["icon","save"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1),c.NdJ("onCancel",(function(){return t.handleCancel()})),c.TgZ(2,"table",2)(3,"thead")(4,"tr",3),c.YNc(5,Ke,4,6,"th",4),c.qZA()(),c.TgZ(6,"tbody"),c.YNc(7,We,2,2,"ng-container",5),c.qZA()(),c.YNc(8,et,3,0,"div",6),c.qZA(),c.TgZ(9,"div"),c.YNc(10,it,15,7,"div",7),c.qZA()()),2&e&&(c.xp6(1),c.Q6J("cancellable",!0)("system-overlay-loading-spinner",t.isLoading),c.xp6(4),c.Q6J("ngForOf",t.displayFields)("ngForTrackBy",t.trackByFn),c.xp6(2),c.Q6J("ngIf",(null==t.presData||null==t.presData.records?null:t.presData.records.length)>0),c.xp6(1),c.Q6J("ngIf",!t.isLoading&&0==(null==t.presData.records?null:t.presData.records.length)),c.xp6(2),c.Q6J("ngIf",t.showFooter))},dependencies:[s.mk,s.sg,s.O5,J.J,Pe.$,A._,Oe.r,be._,qe.h,Le.S,Be],encapsulation:2,changeDetection:0})}return ReporterDetailPresentationStandard})();var nt=i(1135),rt=i(9621),ot=i(3499),at=i(5767),lt=i(1916);function dt(e,t){if(1&e&&(c.TgZ(0,"div",16)(1,"span",17),c._UZ(2,"system-label",18),c.qZA()()),2&e){const e=t.$implicit;c.Q6J("cdkDragData",e),c.xp6(2),c.Q6J("label",e.name)}}function ct(e,t){if(1&e&&(c.TgZ(0,"div",16)(1,"span",17),c._UZ(2,"system-label",18),c.qZA()()),2&e){const e=t.$implicit;c.Q6J("cdkDragData",e),c.xp6(2),c.Q6J("label",e.name)}}const pt=function(e){return[e]};let ut=(()=>{class ReporterDetailSelectFieldsModal{metadata;language;dataChanged$=new nt.X(!1);presentationFields=[];self={};availableFields=[];displayFields=[];constructor(e,t){this.metadata=e,this.language=t}ngOnInit(){this.availableFields=this.presentationFields.filter((e=>"no"==e.display)),this.displayFields=this.presentationFields.filter((e=>"yes"==e.display)),this.availableFields.length>0&&this.sortAvailableFields(),this.displayFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0))}sortAvailableFields(){this.availableFields=this.availableFields.sort(((e,t)=>this.language.getLabel(e.name).toLowerCase()>this.language.getLabel(t.name).toLowerCase()?1:-1))}close(){this.self.destroy()}canSet(){return this.displayFields.length>0}set(){if(this.canSet()){let e=1;for(let t of this.displayFields)t.display="yes",t.sequence=e,t.width||(t.width=25),e++;for(let t of this.availableFields)t.display="no",t.sequence=e,e++;this.presentationFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.dataChanged$.next(!0),this.dataChanged$.complete(),this.close()}}onFieldDrop(e){let t=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,t[0])}static ɵfac=function(e){return new(e||ReporterDetailSelectFieldsModal)(c.Y36(b.Pu),c.Y36(v.d))};static ɵcmp=c.Xpm({type:ReporterDetailSelectFieldsModal,selectors:[["ng-component"]],decls:22,vars:11,consts:[[3,"close"],["label","LBL_SETFIELDS"],[1,"slds-grid"],[1,"slds-form-element","slds-p-horizontal--small","slds-size--1-of-2"],[1,"slds-form-element__label"],["label","LBL_AVAILABLE_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listOne","cdkDropList"],["cdkDrag","","class","slds-drag--preview slds-picklist__item","role","option",3,"cdkDragData",4,"ngFor","ngForOf"],["label","LBL_SELECTED_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1","cdk-drag",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listTwo","cdkDropList"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_SET"],["cdkDrag","","role","option",1,"slds-drag--preview","slds-picklist__item",3,"cdkDragData"],[1,"slds-truncate"],[3,"label"]],template:function(e,t){if(1&e&&(c.TgZ(0,"system-modal")(1,"system-modal-header",0),c.NdJ("close",(function(){return t.close()})),c._UZ(2,"system-label",1),c.qZA(),c.TgZ(3,"system-modal-content")(4,"div",2)(5,"div",3)(6,"span",4),c._UZ(7,"system-label",5),c.qZA(),c.TgZ(8,"div",6,7),c.NdJ("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),c.YNc(10,dt,3,2,"div",8),c.qZA()(),c.TgZ(11,"div",3)(12,"span",4),c._UZ(13,"system-label",9),c.qZA(),c.TgZ(14,"div",10,11),c.NdJ("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),c.YNc(16,ct,3,2,"div",8),c.qZA()()()(),c.TgZ(17,"system-modal-footer")(18,"button",12),c.NdJ("click",(function(){return t.close()})),c._UZ(19,"system-label",13),c.qZA(),c.TgZ(20,"button",14),c.NdJ("click",(function(){return t.set()})),c._UZ(21,"system-label",15),c.qZA()()()),2&e){const e=c.MAs(9),i=c.MAs(15);c.xp6(8),c.Q6J("cdkDropListData",t.availableFields)("cdkDropListConnectedTo",c.VKq(7,pt,i)),c.xp6(2),c.Q6J("ngForOf",t.availableFields),c.xp6(4),c.Q6J("cdkDropListData",t.displayFields)("cdkDropListConnectedTo",c.VKq(9,pt,e)),c.xp6(2),c.Q6J("ngForOf",t.displayFields),c.xp6(4),c.Q6J("disabled",!t.canSet())}},dependencies:[s.sg,A._,rt.j,ot.x,at.p,lt.y,d.Wj,d.Zt],encapsulation:2,changeDetection:0})}return ReporterDetailSelectFieldsModal})();var ht=i(2067);let gt=(()=>{class ReporterDetailVisualizationGooglecharts{renderer;elementRef;metadata;zone;libloader;vizdata={};wrapper=void 0;resizeHandler={};constructor(e,t,i,s,n){this.renderer=e,this.elementRef=t,this.metadata=i,this.zone=s,this.libloader=n,this.resizeHandler=this.renderer.listen("window","resize",(()=>this.onResize()))}ngAfterViewInit(){this.loadGoogleChart()}loadGoogleChart(){this.vizdata.data.options.height||(this.vizdata.data.options.height=this.elementRef.nativeElement.height),this.libloader.loadLib("googlecharts").subscribe((e=>{this.zone.runOutsideAngular((()=>{google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((()=>{this.drawchart()}))}))}))}ngOnDestroy(){this.resizeHandler()}drawchart(){this.wrapper=new google.visualization.ChartWrapper(this.vizdata.data),this.wrapper.draw()}onResize(){this.wrapper&&this.zone.runOutsideAngular((()=>{this.wrapper.draw()}))}static ɵfac=function(e){return new(e||ReporterDetailVisualizationGooglecharts)(c.Y36(c.Qsj),c.Y36(c.SBq),c.Y36(b.Pu),c.Y36(c.R0b),c.Y36(ht.$))};static ɵcmp=c.Xpm({type:ReporterDetailVisualizationGooglecharts,selectors:[["reporter-detail-visualization-googlecharts"]],decls:2,vars:2,consts:[[1,"slds-is-absolute","slds-box--border","slds-p-vertical--small","slds-p-horizontal--small",3,"ngStyle"],[2,"width","100%","height","100%",3,"id"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._UZ(1,"div",1),c.qZA()),2&e&&(c.Q6J("ngStyle",null==t.vizdata?null:t.vizdata.layout),c.xp6(1),c.Q6J("id",t.vizdata.uid))},dependencies:[s.PC],encapsulation:2,changeDetection:0})}return ReporterDetailVisualizationGooglecharts})();function ft(e,t){if(1&e&&c._UZ(0,"reporter-detail-visualization",1),2&e){const e=c.oxw();c.Q6J("parentId",e.parentId)("parentModule",e.parentModule)("displayEmbedded",!0)}}let mt=(()=>{class ReporterVisualizationDashlet{model;reporterconfig;id="";config=void 0;parentModule="";parentId="";componentconfig={};hasVisualization=!1;noAccess=new c.vpe;constructor(e,t){this.model=e,this.reporterconfig=t}ngOnInit(){this.config&&(this.componentconfig=this.config)}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.model.getData().subscribe((e=>{""!=e.visualization_params&&(this.hasVisualization=!0)}),(e=>{"403"!=e.status&&"404"!=e.status||this.noAccess.emit(!0)})))}static ɵfac=function(e){return new(e||ReporterVisualizationDashlet)(c.Y36(p.o),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterVisualizationDashlet,selectors:[["reporter-visualization-dashlet"]],inputs:{id:"id",config:"config",parentModule:"parentModule",parentId:"parentId"},outputs:{noAccess:"noAccess"},features:[c._Bn([p.o,u.s])],decls:1,vars:1,consts:[[3,"parentId","parentModule","displayEmbedded",4,"ngIf"],[3,"parentId","parentModule","displayEmbedded"]],template:function(e,t){1&e&&c.YNc(0,ft,1,3,"reporter-detail-visualization",0),2&e&&c.Q6J("ngIf",t.hasVisualization)},dependencies:[s.O5,_e],encapsulation:2})}return ReporterVisualizationDashlet})();const vt=function(e){return{"slds-hide":e}};let bt=(()=>{class ReporterVisualizationContainer{model;componentconfig={};isHidden=!1;constructor(e){this.model=e}noAccess(e){this.isHidden=e}static ɵfac=function(e){return new(e||ReporterVisualizationContainer)(c.Y36(p.o))};static ɵcmp=c.Xpm({type:ReporterVisualizationContainer,selectors:[["reporter-visualization-container"]],decls:2,vars:6,consts:[[1,"slds-card","slds-m-bottom--medium",2,"height","300px","width","100%",3,"ngClass"],[3,"config","parentModule","parentId","noAccess"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"reporter-visualization-dashlet",1),c.NdJ("noAccess",(function(e){return t.noAccess(e)})),c.qZA()()),2&e&&(c.Q6J("ngClass",c.VKq(4,vt,t.isHidden)),c.xp6(1),c.Q6J("config",t.componentconfig)("parentModule",t.model.module)("parentId",t.model.id))},dependencies:[s.mk,mt],styles:["[_nghost-%COMP%]{height:300px;width:100%}"]})}return ReporterVisualizationContainer})();var wt=i(7579);const yt=["presentationcontainer"];function _t(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"h2",3),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.openReport())})),c.TgZ(1,"span",4),c._uU(2),c.qZA()()}if(2&e){const e=c.oxw();c.xp6(2),c.Oqu(e.model.data.name)}}let xt=(()=>{class ReporterPresentationDashlet{model;metadata;elementRef;toast;language;reporterconfig;presentationcontainer;parentModule="";parentId="";displayheader=!0;componentconfig={};refreshReport=new wt.x;dashletTitle=new c.vpe;presComponent=void 0;noAccess=new c.vpe;constructor(e,t,i,s,n,r){this.model=e,this.metadata=t,this.elementRef=i,this.toast=s,this.language=n,this.reporterconfig=r}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.parentId&&this.parentModule&&(this.model.parentBeanId=this.parentId,this.model.parentBeanModule=this.parentModule),this.model.getData().subscribe({next:e=>{this.dashletTitle.emit(this.model.getField("name")),this.renderPresentation()},error:e=>{"403"==e.status||"404"==e.status?this.noAccess.emit(!0):this.toast.sendToast(this.language.getLabel("LBL_ERROR_LOADING_DATA"),"error")}}))}ngOnInit(){this.refreshReport.subscribe((e=>{e&&this.reporterconfig.refresh()}))}get containerstyle(){this.presentationcontainer.element.nativeElement.getBoundingClientRect();return{height:"calc(100% - "+this.presentationcontainer.element.nativeElement.offsetTop+"px)"}}openReport(){this.model.goDetail()}renderPresentation(){this.presComponent&&(this.presComponent.destroy(),this.presComponent=void 0);let e="";switch(this.model.getField("presentation_params").plugin){case"standard":e="ReporterDetailPresentationStandard";break;case"grouped":e="ReporterDetailPresentationGrouped";break;case"standardws":e="ReporterDetailPresentationStandardWS";break;case"tree":e="ReporterDetailPresentationTree";break;case"pivot":e="ReporterDetailPresentationPivot"}""!=e&&this.metadata.addComponent(e,this.presentationcontainer).subscribe((e=>{e.instance.showFooter=!1,this.presComponent=e}))}static ɵfac=function(e){return new(e||ReporterPresentationDashlet)(c.Y36(p.o),c.Y36(b.Pu),c.Y36(c.SBq),c.Y36(S.A),c.Y36(v.d),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterPresentationDashlet,selectors:[["reporter-presentation-dashlet"]],viewQuery:function(e,t){if(1&e&&c.Gf(yt,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.presentationcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayheader:"displayheader",componentconfig:"componentconfig",refreshReport:"refreshReport"},outputs:{dashletTitle:"dashletTitle",noAccess:"noAccess"},features:[c._Bn([p.o,u.s])],decls:4,vars:2,consts:[["class","slds-text-heading--medium slds-p-around--medium",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["presentationcontainer",""],[1,"slds-text-heading--medium","slds-p-around--medium",3,"click"],[1,"slds-text-link_faux"]],template:function(e,t){1&e&&(c.YNc(0,_t,3,1,"h2",0),c.TgZ(1,"div",1),c._UZ(2,"div",null,2),c.qZA()),2&e&&(c.Q6J("ngIf",t.displayheader),c.xp6(1),c.Q6J("ngStyle",t.containerstyle))},dependencies:[s.O5,s.PC],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]})}return ReporterPresentationDashlet})();const Ft=function(e){return{"slds-hide":e}};let Rt=(()=>{class ReporterPresentationContainer{model;language;reporterconfig;componentconfig={};dashletTitle;isHidden=!1;refreshReport=new wt.x;constructor(e,t,i){this.model=e,this.language=t,this.reporterconfig=i}get title(){return this.dashletTitle?this.dashletTitle:this.language.getModuleName("KReports")}noAccess(e){this.isHidden=e}execute(){this.refreshReport.next(!0)}static ɵfac=function(e){return new(e||ReporterPresentationContainer)(c.Y36(p.o),c.Y36(v.d),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterPresentationContainer,selectors:[["reporter-presentation-container"]],features:[c._Bn([u.s])],decls:13,vars:10,consts:[[1,"slds-card","slds-card_boundary","slds-m-bottom--medium",3,"ngClass"],[1,"slds-card__header","slds-grid","slds-grid--vertical-align-center"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],["module","KReports",3,"size"],[1,"slds-media__body","slds-truncate","slds-grid","slds-grid--vertical-align-center"],[1,"slds-text-heading--small"],[3,"refreshReport","componentconfig","parentModule","parentId","displayheader","dashletTitle","noAccess"],[1,"slds-card__footer"],[1,"slds-grid","slds-grid_align-end"],[1,"slds-text-align--right"],[1,"slds-button","slds-button_icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"header",2),c._UZ(3,"system-icon",3),c.TgZ(4,"div",4)(5,"h2",5),c._uU(6),c.qZA()()()(),c.TgZ(7,"reporter-presentation-dashlet",6),c.NdJ("dashletTitle",(function(e){return t.dashletTitle=e}))("noAccess",(function(e){return t.noAccess(e)})),c.qZA(),c.TgZ(8,"footer",7)(9,"div",8)(10,"div",9)(11,"button",10),c.NdJ("click",(function(){return t.execute()})),c._UZ(12,"system-button-icon",11),c.qZA()()()()()),2&e&&(c.Q6J("ngClass",c.VKq(8,Ft,t.isHidden)),c.xp6(3),c.Q6J("size","small"),c.xp6(3),c.Oqu(t.title),c.xp6(1),c.Q6J("refreshReport",t.refreshReport)("componentconfig",t.componentconfig)("parentModule",t.model.module)("parentId",t.model.id)("displayheader",!1))},dependencies:[s.mk,J.J,I.f,xt],encapsulation:2})}return ReporterPresentationContainer})();var Ct=i(5684),Zt=i(2644),kt=i(6625);let It=(()=>{class ReporterCockpitTile{backend;router;report={};constructor(e,t){this.backend=e,this.router=t}navigateDetail(){this.router.navigate(["/module/KReports/"+this.report.id])}static ɵfac=function(e){return new(e||ReporterCockpitTile)(c.Y36(w.y),c.Y36(y.F0))};static ɵcmp=c.Xpm({type:ReporterCockpitTile,selectors:[["reporter-cockpit-tile"]],hostAttrs:[1,"slds-tile","slds-media","slds-p-vertical--small","slds-card__tile","slds-p-horizontal--small","slds-size--1-of-3","slds-hint-parent"],inputs:{report:"report"},decls:9,vars:4,consts:[[1,"slds-media__figure","slds-m-right--none","slds-p-top--xxx-small"],[3,"module"],[1,"slds-media__body","slds-truncate"],[1,"slds-grid","slds-grid--align-spread","slds-has-flexi-truncate"],[1,"slds-truncate"],["href","javascript:void(0);",3,"click"],[1,"slds-tile__detail","slds-text-body--small",3,"title"],[1,"slds-item--detail","slds-truncate",3,"innerHtml"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._UZ(1,"system-icon",1),c.qZA(),c.TgZ(2,"div",2)(3,"div",3)(4,"h3",4)(5,"a",5),c.NdJ("click",(function(){return t.navigateDetail()})),c._uU(6),c.qZA()()(),c.TgZ(7,"div",6),c._UZ(8,"dd",7),c.qZA()()),2&e&&(c.xp6(1),c.Q6J("module",t.report.report_module),c.xp6(5),c.hij(" ",t.report.name," "),c.xp6(1),c.Q6J("title",t.report.description),c.xp6(1),c.Q6J("innerHtml",t.report.description,c.oJD))},dependencies:[I.f],encapsulation:2})}return ReporterCockpitTile})();function Tt(e,t){if(1&e&&c._UZ(0,"reporter-cockpit-tile",12),2&e){const e=t.$implicit;c.Q6J("report",e)}}function Dt(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",13)(1,"div"),c._uU(2),c._UZ(3,"system-label",14),c._uU(4),c.qZA(),c.TgZ(5,"div",15)(6,"a",16),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw(2).$implicit,i=c.oxw();return c.KtG(i.loadMore(t.bucket))})),c._UZ(7,"system-label",17),c.qZA()()()}if(2&e){const e=c.oxw(2).$implicit;c.xp6(2),c.hij(" ",e.items," "),c.xp6(2),c.hij(" ",e.total," ")}}function Jt(e,t){if(1&e&&(c.TgZ(0,"article",3)(1,"div",4)(2,"header",5)(3,"div",6)(4,"h2")(5,"span",7),c._uU(6),c.qZA()()()()(),c.TgZ(7,"div",8)(8,"div",9),c.YNc(9,Tt,1,1,"reporter-cockpit-tile",10),c.qZA()(),c.YNc(10,Dt,8,2,"div",11),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw();c.xp6(6),c.AsE("",e.bucket," (",e.items,")"),c.xp6(3),c.Q6J("ngForOf",t.getCategoryReports(e.bucket)),c.xp6(1),c.Q6J("ngIf",e.items<e.total)}}function At(e,t){if(1&e&&(c.ynx(0),c.YNc(1,Jt,11,4,"article",2),c.BQk()),2&e){const e=t.$implicit;c.xp6(1),c.Q6J("ngIf",(null==e?null:e.items)>0)}}let Mt=(()=>{class ReporterCockpit{backend;modellist;language;configuration;metadata;componentconfig={};subscriptions=new f.w0;allFields=[];constructor(e,t,i,s,n){this.backend=e,this.modellist=t,this.language=i,this.configuration=s,this.metadata=n}get sortField(){return this.componentconfig.sortfield}get sortDirection(){return this.componentconfig.sortdirection?this.componentconfig.sortdirection:"ASC"}ngOnInit(){this.initialize()}initialize(){this.componentconfig=this.metadata.getComponentConfig("ReporterCockpit",this.modellist.module),this.modellist.loadlimit=15,this.loadCategories(),this.sortField&&this.modellist.setSortField(this.sortField,this.sortDirection),this.subscriptions.add(this.modellist.listType$.pipe((0,Ct.T)(1)).subscribe((e=>this.handleListTypeChange(e))))}handleListTypeChange(e){"ReporterCockpit"==e.listcomponent&&this.modellist.reLoadList()}loadCategories(){const e=this.configuration.getData("reportcategories");e?(this.setBuckets(e),this.modellist.getListData()):this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe((e=>{e&&(this.setBuckets(e),this.modellist.getListData())}))}setBuckets(e){this.modellist.buckets={bucketfield:"category_name",buckettotal:[],bucketitems:e.map((e=>({bucket:e.name,values:{},items:0,hidden:!1})))}}ngOnDestroy(){this.modellist.buckets={}}loadMore(e){this.modellist.loadMoreBucketList(e)}getCategoryReports(e){return this.modellist.listData.list.filter((t=>t.category_name==e))}static ɵfac=function(e){return new(e||ReporterCockpit)(c.Y36(w.y),c.Y36(Zt.t),c.Y36(v.d),c.Y36(kt.C),c.Y36(b.Pu))};static ɵcmp=c.Xpm({type:ReporterCockpit,selectors:[["reporter-cockpit"]],decls:2,vars:2,consts:[[1,"slds-scrollable",2,"height","100%",3,"system-overlay-loading-spinner"],[4,"ngFor","ngForOf"],["class","slds-card slds-m-around--medium",4,"ngIf"],[1,"slds-card","slds-m-around--medium"],[1,"slds-card__header","slds-grid"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],[1,"slds-media__body"],[1,"slds-text-heading--medium"],[1,"slds-card__body","slds-card__body_inner"],[1,"slds-card__body--inner","slds-grid","slds-wrap","slds-grid--pull-padded"],[3,"report",4,"ngFor","ngForOf"],["class","slds-card__footer slds-grid",4,"ngIf"],[3,"report"],[1,"slds-card__footer","slds-grid"],["label","LBL_OF"],[1,"slds-grow"],["href","javascript:void(0);",3,"click"],["label","LBL_MORE"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.YNc(1,At,2,1,"ng-container",1),c.qZA()),2&e&&(c.Q6J("system-overlay-loading-spinner",t.modellist.isLoading),c.xp6(1),c.Q6J("ngForOf",null==t.modellist.buckets?null:t.modellist.buckets.bucketitems))},dependencies:[s.sg,s.O5,A._,be._,It],encapsulation:2})}return ReporterCockpit})();function Yt(e,t){if(1&e&&(c.TgZ(0,"div",1),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ",e.record[e.field.fieldid],"\n")}}let qt=(()=>{class ReporterFieldStandard{record={};field={};static ɵfac=function(e){return new(e||ReporterFieldStandard)};static ɵcmp=c.Xpm({type:ReporterFieldStandard,selectors:[["reporter-field-standard"]],decls:1,vars:1,consts:[["class","slds-truncate",4,"ngIf"],[1,"slds-truncate"]],template:function(e,t){1&e&&c.YNc(0,Yt,2,1,"div",0),2&e&&c.Q6J("ngIf",t.record)},dependencies:[s.O5],encapsulation:2,changeDetection:0})}return ReporterFieldStandard})();var Nt=i(6550);let Pt=(()=>{class ReporterFieldText{sanitizer;record={};field={};value="";constructor(e){this.sanitizer=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){this.record[this.field.fieldid]&&(this.value=this.sanitizer.bypassSecurityTrustHtml(this.record[this.field.fieldid].replace(/(?:\r\n|\r|\n)/g,"<br>")))}static ɵfac=function(e){return new(e||ReporterFieldText)(c.Y36(Nt.H7))};static ɵcmp=c.Xpm({type:ReporterFieldText,selectors:[["reporter-field-text"]],decls:1,vars:1,consts:[[1,"slds-truncate",2,"white-space","normal",3,"innerHTML"]],template:function(e,t){1&e&&c._UZ(0,"div",0),2&e&&c.Q6J("innerHTML",t.value,c.oJD)},encapsulation:2,changeDetection:0})}return ReporterFieldText})();var Ot=i(5547),Lt=i(2422);let Ut=(()=>{class ReporterFieldCurrency{currency;userpreferences;record={};field={};value="";currencySymbol="";constructor(e,t){this.currency=e,this.userpreferences=t}ngOnInit(){this.setCurrencySymbol(),this.setFormattedFieldValue()}setCurrencySymbol(){if(!this.record[this.field.fieldid])return;let e=-99;const t=this.field.fieldid+"_curid",i=this.currency.getCurrencies()||[];t&&(e=this.record[t]);const s=i.find((t=>t.id==e));this.currencySymbol=s?s.symbol:""}setFormattedFieldValue(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid])):this.value=""}static ɵfac=function(e){return new(e||ReporterFieldCurrency)(c.Y36(Ot.A),c.Y36(Lt.z))};static ɵcmp=c.Xpm({type:ReporterFieldCurrency,selectors:[["reporter-field-currency"]],decls:5,vars:2,consts:[[1,"slds-grid","slds-grid--align-end"],[1,"slds-text-align--right"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div"),c._uU(2),c.qZA(),c.TgZ(3,"div",1),c._uU(4),c.qZA()()),2&e&&(c.xp6(2),c.hij(" ",t.currencySymbol," "),c.xp6(2),c.hij(" ",t.value," "))},encapsulation:2,changeDetection:0})}return ReporterFieldCurrency})(),Qt=(()=>{class ReporterFieldPercentage{userpreferences;record={};field={};value="";constructor(e){this.userpreferences=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid]),2,99)+"%":this.value=""}static ɵfac=function(e){return new(e||ReporterFieldPercentage)(c.Y36(Lt.z))};static ɵcmp=c.Xpm({type:ReporterFieldPercentage,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"slds-text-align--center"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._uU(1),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldPercentage})(),zt=(()=>{class ReporterFieldEnum{language;metadata;record={};field={};value="";constructor(e,t){this.language=e,this.metadata=t}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){let e=this.field.path.split("::"),t=e.length;const i=e[t-1].split(":")[1];let s,n=e[t-2].split(":");switch(n[0]){case"root":s=n[1];break;case"link":s=this.metadata.getFieldDefs(n[1],n[2]).module}this.value=i&&s?this.language.getFieldDisplayOptionValue(s,i,this.record[this.field.fieldid+"_val"]):this.record[this.field.fieldid]}static ɵfac=function(e){return new(e||ReporterFieldEnum)(c.Y36(v.d),c.Y36(b.Pu))};static ɵcmp=c.Xpm({type:ReporterFieldEnum,selectors:[["reporter-field-enum"]],decls:2,vars:1,consts:[[1,"slds-truncate","slds-text-align--center"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._uU(1),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldEnum})(),Et=(()=>{class ReporterFieldDate{userpreferences;record={};field={};value="";constructor(e){this.userpreferences=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]);e.isValid()&&(this.value=e.format(this.userpreferences.getDateFormat()))}}static ɵfac=function(e){return new(e||ReporterFieldDate)(c.Y36(Lt.z))};static ɵcmp=c.Xpm({type:ReporterFieldDate,selectors:[["reporter-field-date"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._uU(1),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldDate})(),St=(()=>{class ReporterFieldDateTime{userpreferences;session;cdRef;broadcast;record={};field={};value="";subscription=new f.w0;constructor(e,t,i,s){this.userpreferences=e,this.session=t,this.cdRef=i,this.broadcast=s,this.subscribeToTimezoneChange()}ngOnInit(){this.setFormattedFieldValue()}ngOnDestroy(){this.subscription.unsubscribe()}subscribeToTimezoneChange(){this.subscription.add(this.broadcast.message$.subscribe((e=>{"timezone.changed"==e.messagetype&&(this.setFormattedFieldValue(),this.cdRef.detectChanges())})))}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));e.isValid()&&(this.value=this.userpreferences.formatDateTime(e))}}static ɵfac=function(e){return new(e||ReporterFieldDateTime)(c.Y36(Lt.z),c.Y36(B.n),c.Y36(c.sBO),c.Y36(m.f))};static ɵcmp=c.Xpm({type:ReporterFieldDateTime,selectors:[["reporter-field-date-time"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._uU(1),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldDateTime})(),Bt=(()=>{class ReporterFieldColor{record={};field={};static ɵfac=function(e){return new(e||ReporterFieldColor)};static ɵcmp=c.Xpm({type:ReporterFieldColor,selectors:[["reporter-field-Color"]],decls:3,vars:1,consts:[[1,"slds-align--absolute-center"],["height","16","width","16"],["cx","8","cy","8","r","6","stroke","grey","stroke-width","1"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.O4$(),c.TgZ(1,"svg",1),c._UZ(2,"circle",2),c.qZA()()),2&e&&(c.xp6(2),c.uIk("fill",t.record[t.field.fieldid]))},encapsulation:2})}return ReporterFieldColor})();var Vt=i(7040),Gt=i(6367),Ht=i(3208),jt=i(5638);function Kt(e,t){if(1&e&&c._UZ(0,"field-label",3),2&e){const e=c.oxw();c.Q6J("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function Xt(e,t){if(1&e&&(c.TgZ(0,"option",9),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.id),c.xp6(1),c.hij(" ",e.name," ")}}function $t(e,t){if(1&e&&(c.TgZ(0,"field-generic-display",4)(1,"div",5)(2,"div",6)(3,"select",7),c._UZ(4,"option"),c.YNc(5,Xt,2,2,"option",8),c.qZA()()()()),2&e){const e=c.oxw();c.Q6J("fielddisplayclass",e.fielddisplayclass)("editable",e.isEditable())("fieldconfig",e.fieldconfig)("fieldid",e.fieldid),c.xp6(3),c.Q6J("ngModel",e.valueId)("disabled",!0),c.xp6(2),c.Q6J("ngForOf",e.categories)}}function Wt(e,t){if(1&e&&(c.TgZ(0,"option",9),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.id),c.xp6(1),c.hij(" ",e.name," ")}}function ei(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",10)(1,"div",5)(2,"div",6)(3,"select",11),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.valueId=t)})),c._UZ(4,"option"),c.YNc(5,Wt,2,2,"option",8),c.qZA()()(),c._UZ(6,"field-messages",12),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("ngClass",e.getFieldClass()),c.xp6(3),c.Q6J("ngModel",e.valueId),c.xp6(2),c.Q6J("ngForOf",e.categories),c.xp6(1),c.Q6J("fieldname",e.fieldname)}}let ti=(()=>{class FieldReportCategory extends Vt.O{language;router;view;backend;configuration;metadata;model;categories=[];constructor(e,t,i,s,n,r,o){super(o,i,e,r,t),this.language=e,this.router=t,this.view=i,this.backend=s,this.configuration=n,this.metadata=r,this.model=o,this.loadCategories()}set valueId(e){this.model.setField("category_id",e)}get valueId(){return this.model.getField("category_id")}loadCategories(){const e=this.configuration.getData("reportcategories");e?this.categories=e:this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe((e=>{e&&(this.categories=e)}))}static ɵfac=function(e){return new(e||FieldReportCategory)(c.Y36(v.d),c.Y36(y.F0),c.Y36(g.e),c.Y36(w.y),c.Y36(kt.C),c.Y36(b.Pu),c.Y36(p.o))};static ɵcmp=c.Xpm({type:FieldReportCategory,selectors:[["field-report-category"]],features:[c.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid",4,"ngIf"],["class","slds-form-element",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[1,"slds-form-element__control","slds-p-vertical--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"slds-form-element",3,"ngClass"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"fieldname"]],template:function(e,t){1&e&&(c.YNc(0,Kt,1,2,"field-label",0),c.YNc(1,$t,6,7,"field-generic-display",1),c.YNc(2,ei,7,4,"div",2)),2&e&&(c.Q6J("ngIf",t.displayLabel),c.xp6(1),c.Q6J("ngIf",!t.isEditMode()),c.xp6(1),c.Q6J("ngIf",t.isEditable()&&t.isEditMode()))},dependencies:[s.mk,s.sg,s.O5,n.YN,n.Kr,n.EJ,n.JJ,n.On,Gt.q,Ht.D,jt.a],encapsulation:2})}return FieldReportCategory})(),ii=(()=>{class ReporterIntegrationTargetlistexportButton{language;metadata;model;modal;reporterconfig;constructor(e,t,i,s,n){this.language=e,this.metadata=t,this.model=i,this.modal=s,this.reporterconfig=n}showModal(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.modal.openModal("ReporterIntegrationTargetlistexportModal").subscribe((t=>{t.instance.model=this.model,t.instance.whereConditions=e}))}static ɵfac=function(e){return new(e||ReporterIntegrationTargetlistexportButton)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(p.o),c.Y36(Ne.o),c.Y36(u.s))};static ɵcmp=c.Xpm({type:ReporterIntegrationTargetlistexportButton,selectors:[["reporter-integration-targetlistexport-button"]],decls:5,vars:1,consts:[["role","presentation",1,"slds-dropdown__item",3,"click"],["href","javascript:void(0);","role","menuitem","tabindex","0"],["module","ProspectLists","size","x-small"],[1,"slds-truncate"],["module","ProspectLists",3,"singular"]],template:function(e,t){1&e&&(c.TgZ(0,"li",0),c.NdJ("click",(function(){return t.showModal()})),c.TgZ(1,"a",1),c._UZ(2,"system-icon",2),c.TgZ(3,"span",3),c._UZ(4,"system-label-modulename",4),c.qZA()()()),2&e&&(c.xp6(4),c.Q6J("singular",!0))},dependencies:[I.f,T.M],encapsulation:2})}return ReporterIntegrationTargetlistexportButton})();var si=i(4664);let ni=(()=>{class ReporterIntegrationExportMask{language;constructor(e){this.language=e}static ɵfac=function(e){return new(e||ReporterIntegrationExportMask)(c.Y36(v.d))};static ɵcmp=c.Xpm({type:ReporterIntegrationExportMask,selectors:[["ng-component"]],decls:4,vars:0,consts:[[1,"slds-modal","slds-fade-in-open","slds-align--absolute-center",2,"width","100%","height","100vh"],[1,"slds-box","slds-theme--default"],[1,"slds-backdrop","slds-backdrop--open"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1),c._UZ(2,"system-spinner"),c.qZA()(),c._UZ(3,"div",2))},dependencies:[si.W],encapsulation:2})}return ReporterIntegrationExportMask})(),ri=(()=>{class ReporterIntegrationTargetlistexportModal{language;metadata;backend;modal;self={};model={};whereConditions={};targetlistname="";constructor(e,t,i,s){this.language=e,this.metadata=t,this.backend=i,this.modal=s}closeModal(){this.self.destroy()}exportTargetList(){this.modal.openModal("SystemLoadingModal").subscribe((e=>{e.instance.messagelabel="LBL_CREATING_TARGETLIST";let t={targetlist_action:"new",targetlist_name:this.targetlistname,record:this.model.id,whereConditions:btoa(JSON.stringify(this.whereConditions))};this.backend.postRequest("module/KReports/plugins/action/ktargetlistexport/export_to_targetlist",{},t).subscribe((t=>{e.instance.self.destroy(),this.closeModal()}))}))}static ɵfac=function(e){return new(e||ReporterIntegrationTargetlistexportModal)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(w.y),c.Y36(Ne.o))};static ɵcmp=c.Xpm({type:ReporterIntegrationTargetlistexportModal,selectors:[["reporter-integration-targetlistexport-modal"]],decls:14,vars:1,consts:[["size","large"],[3,"close"],["label","LBL_EXPORT_TO_TARGETLIST_BUTTON_LABEL"],[1,"slds-form-element","slds-p-around--small"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_OK"]],template:function(e,t){1&e&&(c.TgZ(0,"system-modal",0)(1,"system-modal-header",1),c.NdJ("close",(function(){return t.closeModal()})),c._UZ(2,"system-label",2),c.qZA(),c.TgZ(3,"system-modal-content")(4,"div",3)(5,"label",4),c._UZ(6,"system-label",2),c.qZA(),c.TgZ(7,"div",5)(8,"input",6),c.NdJ("ngModelChange",(function(e){return t.targetlistname=e})),c.qZA()()()(),c.TgZ(9,"system-modal-footer")(10,"button",7),c.NdJ("click",(function(){return t.closeModal()})),c._UZ(11,"system-label",8),c.qZA(),c.TgZ(12,"button",9),c.NdJ("click",(function(){return t.exportTargetList()})),c._UZ(13,"system-label",10),c.qZA()()()),2&e&&(c.xp6(8),c.Q6J("ngModel",t.targetlistname))},dependencies:[n.Fj,n.JJ,n.On,A._,rt.j,ot.x,at.p,lt.y],encapsulation:2})}return ReporterIntegrationTargetlistexportModal})();var oi=i(3917);function ai(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"li",1)(1,"a",2),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.exportCSV())})),c._UZ(2,"system-icon",3),c.TgZ(3,"span",4),c._UZ(4,"system-label",5),c.qZA()()()}}let li=(()=>{class ReporterIntegrationCSVexportButton{language;metadata;backend;model;modal;footer;reporterconfig;toast;loadUrl=void 0;fileName=void 0;constructor(e,t,i,s,n,r,o,a){this.language=e,this.metadata=t,this.backend=i,this.model=s,this.modal=n,this.footer=r,this.reporterconfig=o,this.toast=a}get canExport(){return this.model.checkAccess("export")}exportCSV(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.fileName=this.model.getField("name").replace(" ","_")+"_"+moment().format("YYYY_MM_DD_HH_mm_ss")+".csv";let t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getDownloadPostRequestFile("module/KReports/plugins/action/kcsvexport/export",{record:this.model.id,dynamicoptions:JSON.stringify(e)}).subscribe({next:e=>{let i=document.createElement("a");document.body.appendChild(i),i.href=e,i.download=this.fileName,i.type="text/css",i.click(),i.remove(),t.emit(!0)},error:e=>{t.emit(!0),this.toast.sendToast(this.language.getLabel("MSG_ERROR_LOADING_FILE"),"error")}})}static ɵfac=function(e){return new(e||ReporterIntegrationCSVexportButton)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(w.y),c.Y36(p.o),c.Y36(Ne.o),c.Y36(oi.M),c.Y36(u.s),c.Y36(S.A))};static ɵcmp=c.Xpm({type:ReporterIntegrationCSVexportButton,selectors:[["reporter-integration-csvexport-button"]],decls:1,vars:1,consts:[["class","slds-dropdown__item","role","presentation",4,"ngIf"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],["sprite","doctype","icon","csv","size","x-small"],[1,"slds-truncate"],["label","LBL_CSV_EXPORT"]],template:function(e,t){1&e&&c.YNc(0,ai,5,0,"li",0),2&e&&c.Q6J("ngIf",t.canExport)},dependencies:[s.O5,I.f,A._],encapsulation:2})}return ReporterIntegrationCSVexportButton})(),di=(()=>{class ReporterNewButton{language;metadata;model;router;constructor(e,t,i,s){this.language=e,this.metadata=t,this.model=i,this.router=s}execute(){this.hidden||this.router.navigate(["/module/KReports/designer/new"])}get hidden(){return!this.metadata.checkModuleAcl(this.model.module,"create")}static ɵfac=function(e){return new(e||ReporterNewButton)(c.Y36(v.d),c.Y36(b.Pu),c.Y36(p.o),c.Y36(y.F0))};static ɵcmp=c.Xpm({type:ReporterNewButton,selectors:[["ng-component"]],decls:2,vars:0,consts:[["label","LBL_NEW"]],template:function(e,t){1&e&&(c.TgZ(0,"span"),c._UZ(1,"system-label",0),c.qZA())},dependencies:[A._],encapsulation:2})}return ReporterNewButton})(),ci=(()=>{class ReporterFieldCategoryTree{config;metadata;backend;record={};field;categoryNodes={};categoryField;constructor(e,t,i){this.config=e,this.metadata=t,this.backend=i}get display_value(){return this.record[this.field.fieldid]?this.categoryNodes[this.record[this.field.fieldid]]?.node_name??this.record[this.field.fieldid]:""}ngOnInit(){const e=this.setCategoryField();if(!e)return;let t=this.config.getData("categories");this.setCategoryNodes(t[e]),t&&t[e]||(t||(t={}),t[e]=[],this.config.setData("categories",t),this.backend.getRequest(`configuration/spiceui/core/categorytrees/${e}/categorytreenodes`).subscribe((i=>{t[e]=i,this.setCategoryNodes(t[e]),this.config.setData("categories",t)})))}setCategoryField(){let e;const t=this.metadata.getModuleDefs(this.record.sugarRecordModule);return t?.categorytrees?(t.categorytrees.some((t=>{const i=Object.keys(t).find((e=>t[e]==this.field.fieldname));return!!i&&(e=t.syscategorytree_id,this.categoryField=i,!0)})),e):e}setCategoryNodes(e){if(!e||0==e.length)return;let t=2;const i={1:e.filter((e=>!e.parent_id))};if(this.categoryField.endsWith("1"))this.categoryNodes=window._.object(i[1].map((e=>e.node_key)),i[1]);else for(;t<=4;){if(i[t]=[],i[t-1].forEach((s=>{i[t]=i[t].concat(e.filter((e=>e.parent_id==s.id)))})),this.categoryField.endsWith(String(t))){this.categoryNodes=window._.object(i[t].map((e=>e.node_key)),i[t]);break}t++}}static ɵfac=function(e){return new(e||ReporterFieldCategoryTree)(c.Y36(kt.C),c.Y36(b.Pu),c.Y36(w.y))};static ɵcmp=c.Xpm({type:ReporterFieldCategoryTree,selectors:[["reporter-field-category-tree"]],decls:3,vars:1,consts:[[1,"slds-truncate"],[3,"label"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"span"),c._UZ(2,"system-label",1),c.qZA()()),2&e&&(c.xp6(2),c.Q6J("label",t.display_value))},dependencies:[A._],encapsulation:2,changeDetection:0})}return ReporterFieldCategoryTree})(),pi=(()=>{class ModuleReports{static ɵfac=function(e){return new(e||ModuleReports)};static ɵmod=c.oAB({type:ModuleReports});static ɵinj=c.cJS({imports:[s.ez,n.u5,r.ObjectFields,o.ObjectComponents,a.SystemComponents,l.o,d._t]})}return ModuleReports})();("undefined"==typeof ngJitMode||ngJitMode)&&c.kYT(pi,{declarations:[ti,Ze,E,Y,ke,Ie,ve,j,de,K.I,X.i,$.h,Te.f,De.g,Me.i,Ye.Q,Je.W,Ae.K,st,ut,_e,gt,mt,bt,Rt,xt,Mt,It,Be,qt,Pt,Ut,Qt,zt,Et,St,Bt,ci,P,ni,ii,ri,li,L,di],imports:[s.ez,n.u5,r.ObjectFields,o.ObjectComponents,a.SystemComponents,l.o,d._t],exports:[Be,X.i,K.I,$.h,Te.f,Je.W,Ae.K,De.g]})},4542:(e,t,i)=>{i.d(t,{s:()=>a});var s=i(7579),n=i(2242),r=i(6625),o=i(4505);let a=(()=>{class reporterconfig{configurationService;backend;userFilters=[];whereFunctions=[];defaultUserFilters="";operatorCount={};operatorTypes={};operatorAssignments={};isLoading={presentation:!1,visualization:!1};refresh$=new s.x;constructor(e,t){this.configurationService=e,this.backend=t;let i=this.configurationService.getData("reporterConfig");i?this.parseConfifg(i):this.backend.getRequest("module/KReports/core/whereoperators/all").subscribe((e=>{this.configurationService.setData("reporterConfig",e),this.parseConfifg(e)})),this.getWhereFunctions()}getWhereFunctions(){this.backend.getRequest("module/KReports/core/wherefunctions").subscribe((e=>{this.whereFunctions=e}))}parseConfifg(e){this.operatorCount=e.operatorCount,this.operatorTypes=e.operatorTypes,this.operatorAssignments=e.operatorAssignments}refresh(){this.refresh$.next(!0)}cancelRequests(){this.refresh$.next(!1)}resetUserFilters(){this.userFilters=[],this.defaultUserFilters="[]"}addUserFilter(e){this.userFilters.push(e),this.defaultUserFilters=JSON.stringify(this.userFilters)}setDefaultUserFilter(){this.userFilters=JSON.parse(this.defaultUserFilters),this.refresh()}setSavedFilter(e){for(let t of e)this.userFilters.some((e=>{if(e.fieldid==t.fieldid)return e.operator=t.operator,e.value=t.value,e.valuekey=t.valuekey,e.valueto=t.valueto,e.valuetokey=t.valuetokey,!0}));this.refresh()}static ɵfac=function(e){return new(e||reporterconfig)(n.LFG(r.C),n.LFG(o.y))};static ɵprov=n.Yz7({token:reporterconfig,factory:reporterconfig.ɵfac})}return reporterconfig})()}}]);